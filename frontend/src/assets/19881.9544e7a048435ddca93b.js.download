(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[19881,1438],{947040:t=>{t.exports={fade:"fade-zUA5953i"}},891382:t=>{t.exports={"tv-spinner__container-rotate":"tv-spinner__container-rotate-T5YOQaR6"}},882112:t=>{t.exports={}},645300:t=>{t.exports={}},293659:(t,e,s)=>{"use strict";s.d(e,{MiniChartPlotBase:()=>P,isTimePointIndex:()=>T});var i=s(894065),r=s(712433),o=s(800417),a=s(827147),n=s(650151),l=s(724377),h=s(777754),c=s(246733),u=s(389137),d=s(6826),m=s.n(d),_=s(707957),p=s.n(_),g=s(732149),f=s(201089),v=s(919892);const b=(0,f.getLogger)("Chart.MiniChart");function y(t,e,s){return{time:t,color:s,value:e[4]}}function S(t,e){return{time:t,open:e[1],high:e[2],low:e[3],close:e[4]}}function C(t,e,s,i,r){return{time:t,topColor:i,bottomColor:r,lineColor:s,value:e[4]}}function w(t){const e=new Date(t);return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())/1e3}function T(t){return(0,u.isInteger)(t)}const M=["symbol","session","unit-id","currency-id","adjustment","backadjustment","settlement-as-close"];class P{constructor(t,e,s){this._symbolChanged=new(p()),this._volume=null,this._whitespaces=null,this._symbolResolved=new(p()),this._originalScaleMode=null,this._isDestroyed=new(m())(!1),this._status=new(m())(0),this._noData=new(m())(null),this._directionBasedColor=new(m())(null),this._dataLength=null,this._symbol={symbol:""},this._symbolInfo=null,this._availableResolutions=[],this._additionalRightMargin=4,this._timeFrameInvalidated=new(p()),this._whitespaceBuilder=null,this._whitespacePromiseCallbackRef=null,this._firstValueCache=null,this._miniChart=t,this._originalSeriesOptions=e,this._currentSeriesOptions=(0,r.default)({},e),this._originalVolumeOptions=s,this._series=this._createSeries()}destroy(){this._status.unsubscribe(),this._isDestroyed.setValue(!0),this._whitespacePromiseCallbackRef&&(this._whitespacePromiseCallbackRef.callback=null)}status(){return this._status.readonly()}noData(){return this._noData.readonly()}symbolInfo(){return this._symbolInfo}availableResolutions(){return this._availableResolutions}symbol(){return this._symbol.symbol}subSession(){return this._symbol.session}setSymbol(t,e){var s,i;(0,a.default)(t)&&(t={...this._symbol,symbol:t}),void 0!==e&&this._updateSeriesOptions(e),s=this._symbol,i=t,M.every((t=>s[t]===i[t]))||(this._symbol=t,this._whitespacePromiseCallbackRef&&(this._whitespacePromiseCallbackRef.callback=null),this._symbolChanged.fire())}extendedSymbol(){return{...this._symbol,session:this._isLastSessionInterval()?"extended":this._symbol.session}}updateSeriesOptions(t){const e=this._originalSeriesOptions.chartType!==t.chartType;this._updateSeriesOptions(t),e?(this._rebuildSeries(),3===this._status.value()&&this.updateData(!1,!0)):this._series.applyOptions(t)}symbolResolved(){return this._symbolResolved}symbolChanged(){return this._symbolChanged}timeFrameInvalidated(){return this._timeFrameInvalidated}restoreOriginalScaleMode(){null!==this._originalScaleMode&&this._series.priceScale().applyOptions({
mode:this._originalScaleMode})}switchToPercentageScaleMode(){null===this._originalScaleMode&&(this._originalScaleMode=this._series.priceScale().options().mode),this._series.priceScale().applyOptions({mode:i.PriceScaleMode.Percentage})}chartSession(){return this._miniChart.chartSession()}currentSeriesOptions(){return this._currentSeriesOptions}series(){return this._series}volume(){return this._volume}updateData(t,e,s){var i,r;const a=this._miniChart;t&&this.clearSourceData();const n=this._originalSeriesOptions,l=this._buildViewData(s),h=l.series.length;if(0===h)return;const c=()=>{var t,e;if(null!==this._firstValueCache)if("area"===n.chartType){const e=this._currentSeriesOptions,s=l.series;s[(0,o.default)(s,(t=>"value"in t))].value>this._firstValueCache?(e.lineColor=n.growingLineColor||n.lineColor,e.topColor=n.growingTopColor||n.topColor,e.bottomColor=n.growingBottomColor||n.bottomColor):(e.lineColor=n.fallingLineColor||n.lineColor,e.topColor=n.fallingTopColor||n.topColor,e.bottomColor=n.fallingBottomColor||n.bottomColor),this._series.applyOptions({topColor:e.topColor,bottomColor:e.bottomColor,lineColor:e.lineColor}),this._directionBasedColor.setValue(null!==(t=e.lineColor)&&void 0!==t?t:null)}else if("line"===n.chartType){const{color:t,growingColor:s=t,fallingColor:i=t}=n,r=this._currentSeriesOptions,a=l.series;a[(0,o.default)(a,(t=>"value"in t))].value>=this._firstValueCache?r.color=s:r.color=i,this._series.applyOptions({color:r.color}),this._directionBasedColor.setValue(null!==(e=r.color)&&void 0!==e?e:null)}};if(void 0!==s||"area"!==n.chartType&&"line"!==n.chartType||(this._firstValueCache=l.series[0].value),void 0!==s){const t=this._dataLength;if(null===t)return;let e=!1;for(const s of l.series)this._series.update(s),t.lastBarTime<s.time&&(t.lastBarTime=s.time,t.realtime+=1,e=!0);if(null!==this._volume)for(const t of l.volume)this._volume.update(t);if(void 0!==this._whitespacesData&&e){const e=this._whitespacesData.findIndex((e=>e.time>t.lastBarTime));-1===e?(t.whitespaces=0,this._updateWhitespaces([])):0!==e&&(t.whitespaces-=e,this._updateWhitespaces(this._whitespacesData.slice(e)))}return e&&(void 0!==t.fixLeftEdgeUntil?(this._isMainPlot()&&t.fixLeftEdgeUntil>=t.lastBarTime&&this.fitContent(),t.lastBarTime>t.fixLeftEdgeUntil&&(t.history+=t.realtime-1,t.realtime=0,t.fixLeftEdgeUntil=void 0,t.timeFrameInvalidated=!0,this._timeFrameInvalidated.fire())):t.timeFrameInvalidated||(t.timeFrameInvalidated=!0,this._timeFrameInvalidated.fire())),void c()}const u=l.whitespaces,d=null!==(i=null==u?void 0:u.length)&&void 0!==i?i:0;this._dataLength={history:h,realtime:0,lastBarTime:l.series[l.series.length-1].time,whitespaces:d,fixLeftEdgeUntil:l.fixLeftEdgeUntil,timeFrameInvalidated:!1},c(),this._series.applyOptions(this._currentSeriesOptions),null===this._volume&&this._originalVolumeOptions.visible&&(this._volume=a.widget().addHistogramSeries(this._originalVolumeOptions),this._volume.priceScale().applyOptions({scaleMargins:this._originalVolumeOptions.scaleMargins})),this._applyPriceScaleFormatter(),
e||this._beforeDataReady(),this._series.setData(l.series),null===(r=this._volume)||void 0===r||r.setData(l.volume),this._updateWhitespaces(l.whitespaces),this._isMainPlot()&&this._miniChart.resizeByContainer()}updateAdditionalRightMargin(t){this._additionalRightMargin=Math.max(4,t)}fitContent(){if(null===this._dataLength||0===this._dataLength.history)return;const{history:t,realtime:e,whitespaces:s,lastBarTime:i,fixLeftEdgeUntil:r=0}=this._dataLength,o=this._miniChart.widget();let a=.5-(r>=i?0:e),n=t-.5+s+e;const l=(o.options().width-o.priceScale("left").width()-o.priceScale("right").width())/(n-a+1);a-=4/l,n+=this._additionalRightMargin/l,o.timeScale().setVisibleLogicalRange({from:a,to:n}),o.timeScale().applyOptions({lockVisibleTimeRangeOnResize:!0})}deleteView(){var t;this._series.setData([]),null===(t=this._whitespaces)||void 0===t||t.setData([]),this._volume&&(this._volume.setData([]),this._miniChart.widget().removeSeries(this._volume),this._volume=null)}clearData(){this._symbolInfo=null,this._dataLength=null,this._status.setValue(0),this._noData.setValue(null),this._directionBasedColor.setValue(null)}resolution(){return this._miniChart.resolution()}forcePercentageMode(){return!1}lastBarTime(){var t;return null===(t=this._dataLength)||void 0===t?void 0:t.lastBarTime}getViewData(t){return this._buildViewData(t)}isDestroyed(){return this._isDestroyed.readonly()}_isMainPlot(){return!1}_beforeDataReady(){}_onSymbolResolved(t){this._symbolInfo=t,this._availableResolutions=[],"spread"===t.type&&(this._availableResolutions=["D","W","M"]),this._symbolResolved.fire(this._symbolInfo)}_getViewData(t,e){const s={series:[],volume:[]};let i=-1/0;const r=this._bars();if(r.isEmpty())return s;const o=(0,n.ensureNotNull)(this.minBarIndex()),a=null!=e?e:T(o)?o:r.firstIndex(),l=r.lastIndex();if(null===a||null===l)return s;let h;const{premarketLineColor:c,postmarketLineColor:u,premarketTopColor:d,premarketBottomColor:m,postmarketTopColor:_,postmarketBottomColor:p}=this._getPrePostMarketColors(),f=t=>this._isPreMarketBarIndex(t)?[c,d,m]:this._isPostMarketBarIndex(t)?[u,_,p]:[];if(r.range(a,l).each(((e,r)=>{if(e<=g.UNPLOTTABLE_TIME_POINT_INDEX)return!1;const o=this._miniChart.indexToTime(e);if(null===o)return b.logWarn(`Couldn't find time for index ${e}`),!1;const a=w(1e3*o);if(a<=i)return!1;i=a,h=a,s.series.push(t(a,r,...f(e)));const n=r[4]>=r[1]?this._originalVolumeOptions.upColor:this._originalVolumeOptions.downColor;return s.volume.push({time:a,value:r[5],color:n}),!1})),void 0===e&&void 0!==h)switch(this._miniChart.timeframe().value().value){case"1D":s.fixLeftEdgeUntil=h+86400-1;break;case"LASTSESSION":{const t=this.maxBarIndex();if(null!==t&&t>l){let e=[],i=h;if(this._whitespaceBuilder){const t=this._generateWhiteSpacesByBuilder(this._whitespaceBuilder);if(!(null==t?void 0:t.length))break;e=t}else{this._whitespacePromiseCallbackRef&&(this._whitespacePromiseCallbackRef.callback=null);const s=this._whitespacePromiseCallbackRef={callback:t=>{const e=this._generateWhiteSpacesByBuilder(t)
;(null==e?void 0:e.length)&&(this._dataLength&&(this._dataLength.fixLeftEdgeUntil=e[e.length-1].time),this._updateWhitespaces(e),this.fitContent())}};this._initWhitespaceBuilder((0,n.ensureNotNull)(this.symbolInfo())).then((t=>{var e;return null===(e=s.callback)||void 0===e?void 0:e.call(s,t)}));for(let s=l+1;s<=t;s++)i+=60,e.push({time:i})}s.whitespaces=e,s.fixLeftEdgeUntil=e.length>0?e[e.length-1].time:0}}}return s}_buildViewData(t){switch(this._originalSeriesOptions.chartType){case"line":return this._getViewData(y,t);case"area":return this._getViewData(C,t);case"bars":case"candlesticks":return this._getViewData(S,t)}}_isPreMarketBarIndex(t){return!1}_isPostMarketBarIndex(t){return!1}_onSymbolError(t){b.logWarn((0,v.encodeExtendedSymbolOrGetSimpleSymbolString)(this._symbol)+" symbol resolving error: "+t),this.updateData(!0),this._status.setValue(1)}_onSymbolNotPermitted(){this._noData.setValue(1)}_onSymbolGroupNotPermitted(){this._noData.setValue(1)}_onSymbolInvalid(){this._noData.setValue(0)}_onResolutionOrExchangeNotPermittedError(){b.logError((0,v.encodeExtendedSymbolOrGetSimpleSymbolString)(this._symbol)+" resolution or exchange permission error"),this.updateData(!0),this._isMainPlot()&&this._miniChart.showMessage(h.t(null,void 0,s(467093))),this._availableResolutions=["D","W","M"],setTimeout((()=>this._miniChart.updateAvailableTimeframes()),1e3)}_onDataError(){1!==this._status.value()&&this._status.setValue(2),this._noData.setValue(3)}_onDataCompleted(){this._status.setValue(3),this._noData.setValue(0===this._bars().size()?2:null),2===this._noData.value()&&this._isMainPlot()&&this._miniChart.showMessage(h.t(null,void 0,s(180526)))}_onData(t){null!==this.minBarIndex()&&null!==this.maxBarIndex()&&this.updateData(!1,void 0,t)}_isLastSessionInterval(){return"LASTSESSION"===this._miniChart.timeframe().value().value}_updateSeriesOptions(t){this._originalSeriesOptions=t,this._currentSeriesOptions=(0,r.default)({},t)}_rebuildSeries(){this.deleteView(),this._series=this._createSeries()}_createSeries(){const t=this._miniChart.widget();let e;switch(this._currentSeriesOptions.chartType){case"line":e=t.addLineSeries(this._currentSeriesOptions);break;case"area":e=t.addAreaSeries(this._currentSeriesOptions);break;case"bars":e=t.addBarSeries(this._currentSeriesOptions);break;case"candlesticks":e=t.addCandlestickSeries(this._currentSeriesOptions)}return null===this._originalScaleMode&&(this._originalScaleMode=e.priceScale().options().mode),e.priceScale().applyOptions({scaleMargins:this._currentSeriesOptions.scaleMargins}),e}_applyPriceScaleFormatter(){const t=(0,n.ensureNotNull)(this._symbolInfo);if("volume"===t.format)this._currentSeriesOptions.priceFormat={type:"volume",precision:2,minMove:t.minmov/t.pricescale};else{let e=t.pricescale,s=0;for(;e>1;)e/=10,s+=1;this._currentSeriesOptions.priceFormat={type:"price",precision:s,minMove:t.minmov/t.pricescale}}this._series.applyOptions(this._currentSeriesOptions)}_updateWhitespaces(t){
void 0===t||0===t.length?null!==this._whitespaces&&(this._miniChart.widget().removeSeries(this._whitespaces),this._whitespaces=null):(null===this._whitespaces&&(this._whitespaces=this._miniChart.widget().addLineSeries()),this._whitespacesData=null===this._whitespaces?void 0:t,this._whitespaces.setData(t))}async _initWhitespaceBuilder(t){const{WhitespaceBuilder:e}=await Promise.all([s.e(83433),s.e(98192),s.e(11371)]).then(s.bind(s,683096));return this._whitespaceBuilder=new e(t)}_generateWhiteSpacesByBuilder(t){const e=this.symbolInfo(),s=this._bars().lastIndex(),i=this.maxBarIndex();if(e&&s&&i&&s<i&&"LASTSESSION"===this._miniChart.timeframe().value().value){const i=this._miniChart.indexToTime(s);if(null===i)return;return t.update(e),t.extrapolateBarsFrontToTime(this.resolution(),1e3*i).map((t=>({time:w(t)})))}}_getPrePostMarketColors(){let t,e,s,i;const r=this._originalSeriesOptions.premarketLineColor,o=this._originalSeriesOptions.postmarketLineColor;if("area"===this._originalSeriesOptions.chartType&&r&&o){const a=this._currentSeriesOptions,n=a.growingTopColor||a.fallingTopColor||a.topColor;if(void 0!==n){const e=(0,l.tryParseRgba)(n);if(null!==e){const i=e[3];t=(0,c.applyAlpha)(r,i),s=(0,c.applyAlpha)(o,i)}}const h=a.growingBottomColor||a.fallingBottomColor||a.bottomColor;if(void 0!==h){const t=(0,l.tryParseRgba)(h);if(null!==t){const s=t[3];e=(0,c.applyAlpha)(r,s),i=(0,c.applyAlpha)(o,s)}}}return{premarketLineColor:r,postmarketLineColor:o,premarketTopColor:t,postmarketTopColor:s,premarketBottomColor:e,postmarketBottomColor:i}}}},195317:(t,e,s)=>{"use strict";s.d(e,{MiniChartPlot:()=>a});var i=s(534741),r=s(175878),o=s(293659);class a extends o.MiniChartPlotBase{constructor(t,e,s,i,r){super(t,e,s),this._seriesDataSource=null,this._minBarIndex=null,this._maxBarIndex=null,this._studyPlots=i,this._options=r}requestData(){const t=this._getSeriesDataSource();this._minBarIndex=null,this._maxBarIndex=null,this._status.setValue(0),this._noData.setValue(null),t.modifySeries(this.extendedSymbol(),this.resolution(),this._miniChart.timeframe().value()),t.isStarted()||t.start()}clearSourceData(){var t;null===(t=this._seriesDataSource)||void 0===t||t.clearData(),this._studyPlots().forEach((t=>t.clearSourceData()))}moveSourceData(t){var e;null===(e=this._seriesDataSource)||void 0===e||e.moveData(t)}disconnect(){var t;null===(t=this._seriesDataSource)||void 0===t||t.stop()}clearData(){super.clearData(),this._minBarIndex=null,this._maxBarIndex=null,null!==this._seriesDataSource&&(this._seriesDataSource.stop(),this.clearSourceData())}seriesDataSource(){return this._getSeriesDataSource()}firstBar(){return(0,o.isTimePointIndex)(this._minBarIndex)?this._bars().search(this._minBarIndex):this._bars().first()}lastBar(){return(0,o.isTimePointIndex)(this._maxBarIndex)?this._bars().search(this._maxBarIndex,i.PlotRowSearchMode.NearestLeft):this._bars().last()}minBarIndex(){return this._minBarIndex}maxBarIndex(){return this._maxBarIndex}_isMainPlot(){return!0}_beforeDataReady(){this._studyPlots().forEach((t=>t.deleteView()))}
_subscribeToSeriesDataSourceEvents(t){const e=t.dataEvents();e.symbolResolved().subscribe(this,this._onSymbolResolved),e.symbolNotPermitted().subscribe(this,this._onSymbolNotPermitted),e.symbolGroupNotPermitted().subscribe(this,this._onSymbolGroupNotPermitted),e.symbolInvalid().subscribe(this,this._onSymbolInvalid),e.symbolError().subscribe(this,this._onSymbolError),e.intradayExchangeNotPermitted().subscribe(this,this._onResolutionOrExchangeNotPermittedError),e.customIntervalNotPermitted().subscribe(this,this._onResolutionOrExchangeNotPermittedError),e.completed().subscribe(this,this._onDataCompleted),e.seriesError().subscribe(this,this._onDataError),e.seriesTimeFrame().subscribe(this,this._onTimeFrame),e.dataUpdated().subscribe(this,this._onDataInternal)}_unsubscribeFromSeriesDataSourceEvents(t){const e=t.dataEvents();e.symbolResolved().unsubscribe(this,this._onSymbolResolved),e.symbolNotPermitted().unsubscribe(this,this._onSymbolNotPermitted),e.symbolGroupNotPermitted().unsubscribe(this,this._onSymbolGroupNotPermitted),e.symbolInvalid().unsubscribe(this,this._onSymbolInvalid),e.symbolError().unsubscribe(this,this._onSymbolError),e.intradayExchangeNotPermitted().unsubscribe(this,this._onResolutionOrExchangeNotPermittedError),e.customIntervalNotPermitted().unsubscribe(this,this._onResolutionOrExchangeNotPermittedError),e.completed().unsubscribe(this,this._onDataCompleted),e.seriesError().unsubscribe(this,this._onDataError),e.seriesTimeFrame().unsubscribe(this,this._onTimeFrame),e.dataUpdated().unsubscribe(this,this._onDataInternal)}_getSeriesDataSource(){return null===this._seriesDataSource&&(this._seriesDataSource=new r.SeriesDataSource(this.chartSession(),"s"),this._subscribeToSeriesDataSourceEvents(this._seriesDataSource)),this._seriesDataSource}_bars(){return this._getSeriesDataSource().data().bars()}_onTimeFrame(t,e){this._minBarIndex=t,this._maxBarIndex=e,this.updateData(!1),this._studyPlots().forEach((t=>t.updateData(!1,!0)))}_onDataInternal(t,e,s){this._onData(e||null==s?void 0:s.index)}}},668616:(t,e,s)=>{"use strict";s.d(e,{LightweightMiniChart:()=>A});var i=s(894065),r=s(712433),o=s(650151),a=s(551238),n=s(777754),l=s(337779),h=s(201089),c=s(538660),u=s(603517),d=s(223699),m=s(246733),_=s(941285),p=s(157954),g=s(943994),f=s(714688),v=s(464539),b=s(195317),y=s(6826),S=s.n(y),C=s(938550),w=s(947040);const T=(0,h.getLogger)("Chart.MiniChart"),M=new g.VolumeFormatter,P={value:"12M",type:"period-back"},I={top:.01,bottom:.01},D={chartType:"area",lineWidth:2,priceLineVisible:!1,crosshairMarkerVisible:!1,lastValueVisible:!1,scaleMargins:I},x={lineWidth:2,priceLineVisible:!1,crosshairMarkerVisible:!1,lastValueVisible:!1,scaleMargins:I},E={priceLineVisible:!1,lastValueVisible:!1,scaleMargins:I},N={priceLineVisible:!1,lastValueVisible:!1,scaleMargins:I},k={scaleMargins:{top:.8,bottom:0},priceScaleId:"overlay",upColor:(0,m.applyTransparency)(a.colorsPalette["color-minty-green-400"],50),downColor:(0,m.applyTransparency)("#ef5350",50),visible:!1,lastValueVisible:!1,priceLineVisible:!1},R={visible:!1,
color:a.colorsPalette["color-tv-blue-500"],lineWidth:1,length:9,lastValueVisible:!1,priceLineVisible:!1},F={spinner:{visible:!1,width:4,color:a.colorsPalette["color-brand"]},fade:{visible:!1},clearDataOnSymbolChange:!0,clearDataOnTimeframeChange:!0},L={onFirstData:null,description:"",showDescription:!0,valuesTracking:"0",timeframe:{visible:!1,value:P.value,options:new Set(["1D","1M","3M","12M","60M","ALL"])},chartOptions:{minWidth:0,minHeight:0,chart:{grid:{horzLines:{color:"rgba(120, 123, 134, 0.1)",visible:!1},vertLines:{color:"#ffffff",visible:!1}},crosshair:{horzLine:{visible:!1,style:3,width:1,labelVisible:!1},vertLine:{visible:!1,style:3,width:1,labelVisible:!1}},layout:{fontFamily:"Trebuchet MS",fontSize:10,textColor:"#83888D",background:{type:i.ColorType.Solid,color:"transparent"}},watermark:{visible:!1,color:"#83888D",fontSize:12},rightPriceScale:{visible:!0,borderVisible:!1,entireTextOnly:!0,mode:i.PriceScaleMode.Normal},leftPriceScale:{visible:!1,borderVisible:!1,entireTextOnly:!0,mode:i.PriceScaleMode.Normal},timeScale:{borderVisible:!1,timeVisible:!0,secondsVisible:!1,lockVisibleTimeRangeOnResize:!0},handleScale:!1,handleScroll:!1},series:D,volume:k,ma:R,loading:F}},O={"1y":{value:"12M",type:"period-back"},"5y":{value:"60M",type:"period-back"},max:{value:"ALL",type:"period-back"}};function B(t,e){const s=t?(0,o.ensureNotNull)(e).up:(0,o.ensureNotNull)(e).down;return(0,m.resetTransparency)(s)}function V(t,e,s,r){const o={};switch(s){case i.TickMarkType.Year:o.year="numeric";break;case i.TickMarkType.Month:o.month="short";break;case i.TickMarkType.DayOfMonth:o.day="numeric";break;case i.TickMarkType.Time:o.hour12="12-hours"===t,o.hour="2-digit",o.minute="2-digit";break;case i.TickMarkType.TimeWithSeconds:o.hour12="12-hours"===t,o.hour="2-digit",o.minute="2-digit",o.second="2-digit"}const a=new Date(1e3*e);return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()).toLocaleString(r,o)}class A{constructor(t,e,s,o,a=u.miniTimeFrameOptions){var n;this._isDestroyed=!1,this._elTimeframe=null,this._timeframeView=null,this._availableResolutions=[],this._studyPlots=[],this._tickmarks=new Map,this._chartSession=null,this._connectCallback=null,this._connected=!1,this._loadErrorTimeout=null,this._isLoading=!1,this._spinner=null,this._floatingTooltip=null,this._onCrosshairMoveBound=null,this._seriesUpDownColors=null,this._volumeUpDownColors=null,this._isDWMResolution=!1,this._updateTimerId=null,this._width=new(S())(0),this._height=new(S())(0),this.resizeByContainer=()=>{const t=this.container().clientHeight,e=this.container().clientWidth;this._widget.applyOptions({height:t,width:e}),this._mainPlot.fitContent(),this._width.setValue(e),this._height.setValue(t)},this._onPlotStatusChanged=()=>{const t=this._mainPlot.status().value(),e=this._studyPlots.every((t=>0!==t.status().value()));switch(t){case 3:e&&this._onPlotsDataReady();break;case 2:this._onMainPlotDataError();break;case 1:this._onMainPlotSymbolResolvingError()}
if(this._options.chartOptions.loading.fade.visible)switch(t){case 0:this._innerContainer.classList.add(w.fade);break;case 2:case 1:case 3:this._innerContainer.classList.remove(w.fade)}},this._onChartSessionIsConnectedChanged=t=>{var e;t?(this._connected=!0,"function"==typeof this._connectCallback&&this._connectCallback(),null===(e=this._chartSession)||void 0===e||e.switchTimezone("Etc/UTC"),this._requestData()):(this._connected=!1,this._mainPlot.disconnect(),this._studyPlots.forEach((t=>t.disconnect())))},this._options=(0,r.default)({},L,o),this._container=e,this._innerContainer=e.ownerDocument.createElement("div"),this._innerContainer.style.position="relative",e.appendChild(this._innerContainer),this._widget=(0,i.createChart)(this._innerContainer,null===(n=this._options.chartOptions)||void 0===n?void 0:n.chart),this._timeFrameOptions=a,this._tooltipContainer=s,this._timeframe=new C.WatchedObject({type:"period-back",value:this._options.timeframe.value}),this.setTimeframe(this._timeframe.value(),!0),this._mainPlot=this._createMainPlot(t),this.connect(),this._createFloatingTooltip(),window.addEventListener("resize",this.resizeByContainer),this._updateSeriesUpDownColors();const l=this._options.chartOptions.volume;this._volumeUpDownColors={up:l.upColor,down:l.downColor},this.resizeByContainer()}container(){return this._container}getChartContainer(){var t,e,s,i,r;return null!==(r=null===(i=null===(s=null===(e=null===(t=this._container.getElementsByTagName("div").item(0))||void 0===t?void 0:t.getElementsByTagName("table").item(0))||void 0===e?void 0:e.getElementsByTagName("tr").item(0))||void 0===s?void 0:s.getElementsByTagName("td").item(1))||void 0===i?void 0:i.getElementsByTagName("div").item(0))&&void 0!==r?r:null}width(){return this._width.readonly()}height(){return this._height.readonly()}seriesDataSource(){return this._mainPlot.seriesDataSource()}connect(t){"function"==typeof t&&(this._connectCallback=t),this._clearReconnectionTimeout(),this.connected()||(this._showLoading(),this._mainPlot.clearData(),this._studyPlots.forEach((t=>t.clearData())),this._chartSession||(this._chartSession=new c.ChartSession(window.ChartApiInstance,!0)),this._chartSession.isConnected().subscribe(this._onChartSessionIsConnectedChanged),this._chartSession.criticalError().subscribe(this,this._onChartSessionCriticalError),this._chartSession.connect(this._onData.bind(this)),this._clearLoadErrorTimeout(),this._loadErrorTimeout=setTimeout((()=>{this.showMessage(n.t(null,void 0,s(516817))),"function"==typeof this._options.onFirstData&&(this._options.onFirstData(),this._options.onFirstData=null)}),15e3))}disconnect(){if(!this.connected())return;const t=(0,o.ensureNotNull)(this._chartSession);t.criticalError().unsubscribe(this,this._onChartSessionCriticalError),t.isConnected().unsubscribe(this._onChartSessionIsConnectedChanged),this._studyPlots.forEach((t=>t.disconnect())),this._mainPlot.disconnect(),this._chartSession&&this._chartSession.isConnected().value()&&this._chartSession.disconnect(),this._connected=!1,this._clearLoadErrorTimeout()}
connected(){return Boolean(this._connected&&this._chartSession&&this._chartSession.isConnected().value())}setTimeframe(t,e=!1){const s=this._timeframe.value();let i=t;const r=O[i.value];void 0!==r&&(i=r);const o=this._timeframeIsValid(i)?i:P;this._timeframe.setValue(o),this._activeRange=this._timeframe.value().value,this._timeframeView&&this._options.timeframe.visible&&this._timeframeView.update({activeRange:this._activeRange}),e||s===this._timeframe.value()||this._requestDataOnTimeframeChange()}chartSession(){return(0,o.ensureNotNull)(this._chartSession)}widget(){return this._widget}timeframe(){return this._timeframe.readonly()}setTimeFrameOptions(t){if(t===this._timeFrameOptions)return;const e=this.resolution();this._timeFrameOptions=t,this.resolution()!==e&&this._requestDataOnTimeframeChange()}timeFrameOptions(){return this._timeFrameOptions}resolution(){const t=this._timeFrameOptions.find((t=>t.value.value===this.timeframe().value().value));return(0,o.ensureDefined)(null==t?void 0:t.targetResolution)}changeSymbol(t,e){void 0!==e&&this._updateSeriesOptions(e),this._options.chartOptions.loading.clearDataOnSymbolChange&&(this._mainPlot.deleteView(),this._studyPlots.forEach((t=>t.deleteView()))),this._mainPlot.setSymbol(t,this._options.chartOptions.series),this._mainPlot.requestData(),this._studyPlots.forEach((t=>t.requestData())),this.connect()}updateSeriesOptions(t){this._updateSeriesOptions(t),this._updateSeriesUpDownColors(),this._mainPlot.updateSeriesOptions(t)}getSeriesOptions(){return this._mainPlot.currentSeriesOptions()}showMessage(t){this._hideLoading(),this._mainPlot.deleteView(),this._studyPlots.forEach((t=>t.deleteView())),this._widget.applyOptions({watermark:{visible:!0,text:t}})}hideMessage(){this._widget.applyOptions({watermark:{visible:!1}})}from(){const t=this._timeFrameOptions.find((t=>t.value.value===this.timeframe().value().value));return[null==t?void 0:t.from]}enable(t){this.connect(t)}disable(){this.disconnect()}destroy(){var t,e;window.removeEventListener("resize",this.resizeByContainer),this.disconnect(),this._destroyFloatingTooltip(),this._widget.remove(),this._mainPlot.symbolResolved().unsubscribeAll(null),this._mainPlot.timeFrameInvalidated().unsubscribeAll(this),this._mainPlot.destroy(),this._studyPlots.forEach((t=>t.destroy())),null===(t=this._timeframeView)||void 0===t||t.destroy(),null===(e=this._chartSession)||void 0===e||e.destroy(),this._isDestroyed=!0}updateAvailableTimeframes(){const t=this._mainPlot.availableResolutions().slice()||[],e=this._mainPlot.symbolInfo();e?(t.push(...e.resolutions||[]),this._availableResolutions=(0,l.uniq)(t),this._timeframeView&&this._options.timeframe.visible&&this._timeframeView.update({ranges:this._getAvailableTimeFrames()}),this.setTimeframe(this._timeframe.value())):T.logWarn("Updating available resolutions without full symbol info")}mainPlot(){return this._mainPlot}hasStudyPlots(){return this._studyPlots.length>0}addStudyPlot(t){return this._studyPlots.push(t),t.status().subscribe(this._onPlotStatusChanged),
this.connected()?t.requestData():this.connect(),t.forcePercentageMode()&&this._mainPlot.switchToPercentageScaleMode(),{noData:t.noData(),status:t.status(),remove:()=>{this._removeStudyPlot(t)},symbol:()=>t.symbol(),options:()=>t.currentSeriesOptions()}}indexToTime(t){var e,s;return null!==(s=null===(e=this._tickmarks.get(t))||void 0===e?void 0:e.time)&&void 0!==s?s:null}subscribeCrosshairMove(t){this.unsubscribeCrosshairMove(),this._onCrosshairMoveBound=e=>{t(this._onCrosshairMoveHandler(e))},this._widget.subscribeCrosshairMove(this._onCrosshairMoveBound)}unsubscribeCrosshairMove(){this._onCrosshairMoveBound&&this._widget.unsubscribeCrosshairMove(this._onCrosshairMoveBound)}updateChartRightMargin(){const t=[this.mainPlot(),...this._studyPlots].map((t=>t.currentSeriesOptions().title)).map((t=>{var e;return null!==(e=null==t?void 0:t.length)&&void 0!==e?e:0})),e=Math.max(...t);this.mainPlot().updateAdditionalRightMargin(12*e),this.mainPlot().fitContent()}activeRange(){return this._activeRange}_getChartPlotClass(){return b.MiniChartPlot}_createMainPlot(t){const e=new(this._getChartPlotClass())(this,this._options.chartOptions.series,this._options.chartOptions.volume,(()=>this._studyPlots),this._options.mainPlotOptions);return e.setSymbol(t),e.symbolResolved().subscribe(this,this._onSymbolResolved),e.timeFrameInvalidated().subscribe(this,this._onTimeFrameInvalidated),e.status().subscribe(this._onPlotStatusChanged),e}_removeStudyPlot(t){const e=this._studyPlots.indexOf(t);(0,o.assert)(-1!==e),this._studyPlots.splice(e,1),t.status().unsubscribe(this._onPlotStatusChanged),t.deleteView(),t.clearData(),t.destroy(),this._studyPlots.every((t=>!t.forcePercentageMode()))&&this._mainPlot.restoreOriginalScaleMode()}_updateSeriesUpDownColors(){var t,e;const s=this._options.chartOptions.series;switch(s.chartType){case"candlesticks":this._seriesUpDownColors={up:null!==(t=s.borderUpColor)&&void 0!==t?t:s.upColor,down:null!==(e=s.borderDownColor)&&void 0!==e?e:s.downColor};break;case"bars":this._seriesUpDownColors={up:s.upColor,down:s.downColor};break;default:this._seriesUpDownColors=null}}_updateSeriesOptions(t){this._options.chartOptions.series=function(t){var e;let s;switch(null!==(e=t.chartType)&&void 0!==e?e:"area"){case"bars":s=E;break;case"candlesticks":s=N;break;case"area":s=D;break;case"line":s=x}return(0,r.default)({},s,t)}(t)}_onPlotsDataReady(){"function"==typeof this._options.onFirstData&&(this._options.onFirstData(),this._options.onFirstData=null),this._hideLoading(),this.hideMessage(),this._clearLoadErrorTimeout(),this._options.doNotDisconnectOnDataReady||this.disconnect(),this._createReconnectionTimeout()}_onMainPlotDataError(){this._hideLoading(),this.showMessage(n.t(null,void 0,s(482751))),this._clearLoadErrorTimeout(),this.disconnect()}_onMainPlotSymbolResolvingError(){this._hideLoading(),this.showMessage(n.t(null,void 0,s(516817))),this._clearLoadErrorTimeout(),this.disconnect()}_createReconnectionTimeout(){if(this._options.doNotDisconnectOnDataReady)return;const t=this._options.updateTimeout
;void 0!==t&&t>0&&(this._updateTimerId=setTimeout((()=>{this._updateTimerId=null,this.connected()?this._requestData():this.connect()}),t))}_clearReconnectionTimeout(){null!==this._updateTimerId&&(clearInterval(this._updateTimerId),this._updateTimerId=null)}_clearLoadErrorTimeout(){this._loadErrorTimeout&&(clearTimeout(this._loadErrorTimeout),this._loadErrorTimeout=null)}_onCrosshairMoveHandler(t){var e,s;const{point:i,time:r,seriesData:o}=t,a=this._mainPlot.series(),n=this._mainPlot.volume();if(void 0===i||void 0===r)return;const l=o.get(a);if(void 0===l)return;const h=n&&(null!==(s=null===(e=o.get(n))||void 0===e?void 0:e.value)&&void 0!==s?s:null),c=null!==h?M.format(h):void 0;let u,d,m;const _=a.priceFormatter();if("Area"===a.seriesType()||"Line"===a.seriesType()){const{value:t,color:e}=l;u=_.format(t);const s=this._mainPlot.currentSeriesOptions();"line"===s.chartType?d=e||s.color:"area"===s.chartType&&(d=s.lineColor)}else{const t=l;u=[_.format(t.open),_.format(t.high),_.format(t.low),_.format(t.close)];const e=t.close>=t.open;d=B(e,this._seriesUpDownColors),void 0!==c&&(m=B(e,this._volumeUpDownColors))}const p=[];this._studyPlots.forEach((e=>{p.push(...e.getLegendData(t))}));const g=new Date(1e3*r);let f=this._tooltipDateTimeFormatter.format(g);this._isDWMResolution||(f+=" "+function(t){if(0===t)return"UTC";const e=Math.abs(t),s=Math.floor(e/60),i=e-60*s;return`UTC${Math.sign(t)<=0?"+":"-"}${s}${i>0?`:${i}`:""}`}(g.getTimezoneOffset()));return{cursorPosition:{x:this._widget.priceScale("left").width()+i.x,y:i.y},time:f,prices:u,volume:c,studyPlots:p,priceColor:d,volumeColor:m}}_initTimeframeSelector(){if(!this._options.timeframe.visible||this._timeframeView)return;this._options.timeframe.container?this._elTimeframe=this._options.timeframe.container:(this._elTimeframe=document.createElement("div"),this._container.appendChild(this._elTimeframe));const t=(t,e)=>{this._timeframeView=new t.TimeFrameViewRenderer((0,o.ensureNotNull)(this._elTimeframe),{name:"minichart_timeframe",activeRange:this._activeRange,ranges:this._getAvailableTimeFrames(),onSelectRange:t=>{this.setTimeframe({value:t,type:"period-back"}),(0,o.ensureNotNull)(this._timeframeView).update({activeRange:t})},theme:e})};Promise.all([s.e(89053),s.e(50690),s.e(31891)]).then(s.bind(s,358450)).then((e=>{(this._options.timeframe.getTheme||(()=>Promise.resolve(void 0)))().then((s=>t(e,s)))}))}_getAvailableTimeFrames(){const t=[],e=this._options.timeframe.options;for(const s of this._timeFrameOptions)this._timeframeIsValid(s.value)&&e.has(s.value.value)&&t.push({value:s.value.value,text:s.text,description:s.description});return t}_timeframeIsValid(t){const e=this._timeFrameOptions.find((e=>e.value.value===t.value)),s=!!e,i=this._availableResolutions&&this._availableResolutions.length;let r=!1;if(e&&i){const t=/(\d+)(\w+)/.exec(e.targetResolution);null!==t&&-1!==this._availableResolutions.indexOf(t[2])&&(r=!0)}return s&&(!i||r)}_onChartSessionCriticalError(){this._connected=!1}_requestData(){this._clearReconnectionTimeout()
;const t=d.Interval.parse(this.resolution());let e,s;this._isDWMResolution=t.isDWM(),this._widget.timeScale().applyOptions({timeVisible:!this._isDWMResolution,secondsVisible:t.isSeconds()});const{dateFormat:i="dd MMM 'yy",timeHoursFormat:r="24-hours"}=this._options.chartOptions;this._isDWMResolution?e=s=new p.DateFormatter(i):(e=new f.DateTimeFormatter({dateFormat:i,timeFormat:(0,v.getTimeFormatForInterval)(t,r)}),s=new f.DateTimeFormatter({dateFormat:i,timeFormat:(0,v.getTimeFormatForInterval)(t,r),dateTimeSeparator:"\n"})),this._tooltipDateTimeFormatter=s,this._widget.applyOptions({localization:{timeFormatter:t=>e.format(new Date(1e3*t))},timeScale:{tickMarkFormatter:V.bind(null,r)}}),this._mainPlot.requestData(),this._studyPlots.forEach((t=>t.requestData())),this._widget.applyOptions({timeScale:{timeVisible:!d.Interval.parse(this._mainPlot.resolution()).isDWM()}})}_onData(t){switch(t.method){case"timescale_update":{const e=t.params;if(e.clear){this._tickmarks.clear(),this._mainPlot.clearSourceData();for(const t of this._studyPlots)t.clearSourceData()}if(e.index_diff.length>0){this._mainPlot.moveSourceData(e.index_diff);for(const t of this._studyPlots)t.moveSourceData(e.index_diff)}const s=e.marks;for(const t of s)this._tickmarks.set(t.index,t);break}}}_onSymbolResolved(){this.updateAvailableTimeframes(),this._initTimeframeSelector()}_onTimeFrameInvalidated(){var t;this._activeRange=void 0,null===(t=this._timeframeView)||void 0===t||t.update({activeRange:void 0})}_showLoading(){if(this._isLoading)return;this.hideMessage();const t=this._options.chartOptions.loading;t.spinner.visible&&(null===this._spinner&&(this._spinner=new _.Spinner("mini").setStyle({color:t.spinner.color,width:t.spinner.width.toString(),zIndex:"10"})),this._spinner.spin(this._innerContainer)),t.fade.visible&&this._innerContainer.classList.add(w.fade),this._isLoading=!0}_hideLoading(){this._isLoading&&(this._spinner&&this._spinner.stop(),this._isLoading=!1)}_createFloatingTooltip(){if(this._tooltipContainer){const{position:t}=window.getComputedStyle(this._tooltipContainer),e=["relative","fixed","absolute"];e.includes(t)||T.logWarn("Container position property must be: "+e.join(", "))}const t=this._options.valuesTracking;if("3"===t||"0"===t)return;const e=async t=>{var e,i;const r=await Promise.all([s.e(72786),s.e(50690),s.e(10748)]).then(s.bind(s,667704));if(!this._isDestroyed)switch(t){case"1":this._floatingTooltip=new r.FloatingPriceTimeTooltipRenderer(null!==(e=this._tooltipContainer)&&void 0!==e?e:void 0,this._innerContainer);break;case"2":this._floatingTooltip=new r.FloatingPriceTimeTooltipRenderer(null!==(i=this._tooltipContainer)&&void 0!==i?i:void 0,this._innerContainer,"line")}};let i;this.subscribeCrosshairMove((s=>{null===this._floatingTooltip?(i=i||e(t),i.then((()=>{var t;return null===(t=this._floatingTooltip)||void 0===t?void 0:t.update(s)}))):this._floatingTooltip.update(s)}))}_destroyFloatingTooltip(){this._floatingTooltip&&(this._floatingTooltip.destroy(),this.unsubscribeCrosshairMove(),this._floatingTooltip=null)}
_requestDataOnTimeframeChange(){this._options.chartOptions.loading.clearDataOnTimeframeChange&&(this.mainPlot().deleteView(),this._studyPlots.forEach((t=>t.deleteView()))),this.connected()?this._requestData():this.connect()}}},607436:(t,e,s)=>{"use strict";s.d(e,{DEFAULT_SIZE:()=>i,spinnerSizeMap:()=>r});const i="large",r={mini:"xsmall",xsmall:"xsmall",small:"small",medium:"medium",large:"large"}},849204:(t,e,s)=>{"use strict";s.r(e),s.d(e,{LogoSize:()=>i,LogoUrlResolver:()=>a,getLogoUrlResolver:()=>l});var i,r=s(650151),o=s(588948);!function(t){t[t.Medium=0]="Medium",t[t.Large=1]="Large"}(i||(i={}));class a{constructor(t){(0,r.assert)(""!==t,"S3 base url must be a non-empty string"),this._baseUrl=t}getSymbolLogoUrl(t,e){switch((0,r.assert)(""!==t,"logo id must be a non-empty string"),e){case i.Medium:return this._baseUrl+`${t}.svg`;case i.Large:return this._baseUrl+`${t}--big.svg`}}getCountryFlagUrl(t,e){return this.getSymbolLogoUrl("country/"+t,e)}getCryptoLogoUrl(t,e){return this.getSymbolLogoUrl("crypto/"+t,e)}getProviderLogoUrl(t,e){return this.getSymbolLogoUrl("provider/"+t,e)}}let n;function l(){if(!n){const t=(0,o.getInitData)(),e=t.settings?t.settings.S3_LOGO_SERVICE_BASE_URL:"";n=new a(e)}return n}},226722:(t,e,s)=>{"use strict";s.d(e,{TVXWindowEvents:()=>a});s(586463);var i=s(201089),r=s(49437);const o=(0,i.getLogger)("XWindowEvents");var a;!function(t){const e="tvxwevents.",s={};let i;window.BroadcastChannel?(i=new BroadcastChannel("tvxwevents"),i.addEventListener("message",(function(t){const{data:{event:e,value:i}}=t;s[e]&&s[e].forEach((t=>{t(i)}))})),function(){const t=[],s=performance.now();for(let s=0;s<r.TVLocalStorage.length;s++){const i=r.TVLocalStorage.key(s);i.startsWith(e)&&t.push(i)}const i=r.TVLocalStorage.length;for(const e of t)r.TVLocalStorage.removeItem(e);const a=performance.now()-s;o.logNormal(`Total keys amount in local storage on operation start: ${i}`),o.logNormal(`Keys amount in local storage to be deleted: ${t.length}`),o.logNormal(`Keys to be deleted from local storage: ${JSON.stringify(t)}`),o.logNormal(`Removing keys from local storage took ${a} ms`)}()):window.addEventListener("storage",(function(t){const{newValue:i,key:o}=t;if(null===i||!o||!o.startsWith(e))return;const a=o.substring(e.length);s[a]&&s[a].forEach((e=>{e(t.newValue)}));r.TVLocalStorage.removeItem(o)})),t.on=function(t,e){s[t]||(s[t]=[]),s[t].push(e)},t.off=function(t,e){if(!s[t])return;const i=s[t].indexOf(e);-1!==i&&(1===s[t].length?delete s[t]:s[t].splice(i,1))},t.emit=function(t,s=Date.now()){try{i?i.postMessage({event:t,value:s}):r.TVLocalStorage.setItem(e+t,s.toString())}catch(t){o.logError(t.message)}}}(a||(a={}))},17966:(t,e,s)=>{"use strict";s.d(e,{getCircleLogoAnyHtml:()=>o});var i=s(562840),r=s(315723);function o(t){const{logoUrls:e,...s}=t;return 1===e.length?(0,i.getCircleLogoHtml)({logoUrl:e[0],...s}):2===e.length?(0,r.getCircleLogoPairHtml)({primaryLogoUrl:e[0],secondaryLogoUrl:e[1],...s}):(0,i.getCircleLogoHtml)({logoUrl:void 0,...s})}},607546:(t,e,s)=>{"use strict";s.d(e,{getLogoUrlsHook:()=>o})
;var i=s(849204);const r=(0,i.getLogoUrlResolver)();function o(t,e){let s=!1;return(o,n,l)=>{const h=o["currency-logoid"]&&o["base-currency-logoid"];if(!s&&(o.logoid||h||l)){s=!0;const n=function(t){if(2!==t.length)return t;if(function(t){return t.some((t=>a(t)))}(t)&&!function(t){return t.some((t=>t.includes("country")&&!a(t)))}(t))return t.filter((t=>!a(t)));return t}(function(t,e=i.LogoSize.Medium){const s=t.logoid,o=t["base-currency-logoid"],a=t["currency-logoid"],n=s&&r.getSymbolLogoUrl(s,e);if(n)return[n];const l=o&&r.getSymbolLogoUrl(o,e),h=a&&r.getSymbolLogoUrl(a,e);return l&&h?[l,h]:l?[l]:h?[h]:[]}({logoid:o.logoid,"base-currency-logoid":o["base-currency-logoid"],"currency-logoid":o["currency-logoid"]},e));t(n)}}}function a(t){return t.includes("country/US")}},315723:(t,e,s)=>{"use strict";s.d(e,{getCircleLogoPairHtml:()=>r});var i=s(439378);s(882112);function r(t){const{primaryLogoUrl:e,secondaryLogoUrl:s,size:r,className:a}=t;return`<span class="${(0,i.getBlockStyleClasses)(r,a)}">\n\t\t\t${o({logoUrl:s,size:r})}\n\t\t\t${o({logoUrl:e,size:r})}\n\t\t</span>`}function o(t){const{logoUrl:e,size:s}=t,r=(0,i.getLogoStyleClasses)(s,Boolean(e));return void 0===e?`<span class="${r}"></span>`:`<img class="${r}" src="${e}" alt="" />`}},439378:(t,e,s)=>{"use strict";s.d(e,{getBlockStyleClasses:()=>r,getLogoStyleClasses:()=>o});var i=s(497754);function r(t,e){return i("tv-circle-logo-pair",`tv-circle-logo-pair--${t}`,e)}function o(t,e){return i("tv-circle-logo-pair__logo",`tv-circle-logo-pair__logo--${t}`,!e&&"tv-circle-logo-pair__logo-empty")}},562840:(t,e,s)=>{"use strict";s.d(e,{getCircleLogoHtml:()=>r});var i=s(783036);s(645300);function r(t){const e=(0,i.getStyleClasses)(t.size,t.className);return(0,i.isCircleLogoWithUrlProps)(t)?`<img class="${e}" src="${t.logoUrl}" alt="">`:`<span class="${e}">${t.placeholderLetter||""}</span>`}},783036:(t,e,s)=>{"use strict";s.d(e,{getStyleClasses:()=>r,isCircleLogoWithUrlProps:()=>o});var i=s(497754);function r(t,e){return i("tv-circle-logo",`tv-circle-logo--${t}`,e)}function o(t){return"logoUrl"in t&&void 0!==t.logoUrl&&0!==t.logoUrl.length}},538660:(t,e,s)=>{"use strict";s.d(e,{ChartSession:()=>u});var i=s(707957),r=s.n(i),o=s(650151),a=s(6826),n=s.n(a),l=s(541558);const h=(0,s(201089).getLogger)("ChartApi.AbstractSession");var c=s(389137);class u extends class{constructor(t,e,s){this._isConnected=new(n())(!1),this._state=0,this._isConnectForbidden=!1,this._sessionId="",this._sessionIdChanged=new(r()),this._chartApi=t,this._sessionPrefix=e,this._shouldReconnectAfterCriticalError=s}destroy(){this._logNormal("Destroying session"),this._isConnected.unsubscribe(),this.disconnect(),this._sessionIdChanged.destroy(),delete this._chartApi,this._logNormal("Session has been destroyed")}isConnected(){return this._isConnected}sessionId(){return this._sessionId}onSessionIdChanged(){return this._sessionIdChanged}connect(){0===this._state&&((0,o.assert)(!this._isConnectForbidden,"Cannot call connect because it is forbidden at this moment"),this._setSessionId(`${this._sessionPrefix}_${(0,
l.randomHash)()}`),this._logNormal("Connecting session - wait until transport stay connected"),this._state=1,this._chartApi.createSession(this._sessionId,this))}disconnect(){0!==this._state&&((0,o.assert)(""!==this._sessionId,"sessionId must not be invalid"),this._logNormal("Disconnecting session..."),this._forbidConnectWhile((()=>{this._chartApi.connected()&&this._sendRemoveSession(),this._processDestroyingOnServer()})))}onMessage(t){switch(t.method){case"connected":return void this._onChartApiConnected();case"disconnected":return void this._onChartApiDisconnected();case"critical_error":const e=String(t.params[0]),s=String(t.params[1]);return void this._onCriticalError(e,s)}this._onMessage(t)}_getChartApi(){return this._chartApi}_generateLogMessage(t){return`[${this._sessionId}] ${t}`}_onCriticalError(t,e){this._logError(`Critical error. Reason=${t}, info=${e}.`),this._forbidConnectWhile((()=>{this._processDestroyingOnServer()})),this._shouldReconnectAfterCriticalError?(this._logNormal("Reconnecting after critical error..."),this.connect()):this._logNormal("Reconnecting after critical error skipped")}_onChartApiConnected(){(0,o.assert)(1===this._state,"Session is not registered"),this._logNormal("Transport is connected. Creating session on the server"),this._sendCreateSession(),this._state=2,this._isConnected.setValue(!0)}_onChartApiDisconnected(){this._logNormal("Transport is disconnected. Reconnecting..."),this._forbidConnectWhile((()=>{this._processDestroyingOnServer()})),this.connect()}_setSessionId(t){const e=this._sessionId;this._logNormal(`Changing sessionId: old=${e}, new=${t}`),this._sessionId=t,this._sessionIdChanged.fire(t,e)}_logNormal(t){h.logNormal(this._generateLogMessage(t))}_logError(t){h.logError(this._generateLogMessage(t))}_processDestroyingOnServer(){this._state=0,this._isConnected.setValue(!1),this._chartApi.removeSession(this._sessionId),this._setSessionId("")}_forbidConnectWhile(t){this._isConnectForbidden=!0,t(),this._isConnectForbidden=!1}}{constructor(t,e=!1){super(t,"cs",!1),this._sessionDisabled=!1,this._handler=null,this._criticalError=new(r()),this._symbolResolveMap=new Map,this._disableStatistics=e}destroy(){this._criticalError.destroy(),this._handler=null,this._symbolResolveMap.clear(),super.destroy()}serverTimeOffset(){return this._getChartApi().serverTimeOffset()}switchTimezone(t){return this._getChartApi().switchTimezone(this.sessionId(),t)}defaultResolutions(){return this._getChartApi().defaultResolutions()}availableCurrencies(){return this._getChartApi().availableCurrencies()}availableUnits(){return this._getChartApi().availableUnits()}availablePriceSources(){return this._getChartApi().availablePriceSources()}resolveSymbol(t,e,s){if(this._symbolResolveMap.has(e)){const[t,i]=this._symbolResolveMap.get(e);return Array.isArray(i)?i.push(s):i.then(s),t}{const i=[s];return this._getChartApi().resolveSymbol(this.sessionId(),t,e,(s=>{"symbol_error"===s.method?this._symbolResolveMap.delete(e):this._symbolResolveMap.set(e,[t,Promise.resolve(s)]),i.forEach((t=>t(s)))})),
this._symbolResolveMap.set(e,[t,i]),t}}requestFirstBarTime(t,e,s){return this._getChartApi().requestFirstBarTime(this.sessionId(),t,e,s)}createSeries(t,e,s,i,r,o,a){return this._getChartApi().createSeries(this.sessionId(),t,e,s,i,r,o,a)}modifySeries(t,e,s,i,r,o){return this._getChartApi().modifySeries(this.sessionId(),t,e,s,i,r,o)}removeSeries(t){return!!this.isConnected().value()&&this._getChartApi().removeSeries(this.sessionId(),t)}requestMoreData(t,e,s){return"number"==typeof t?this._getChartApi().requestMoreData(this.sessionId(),t):this._getChartApi().requestMoreData(this.sessionId(),t,e,s)}requestMoreTickmarks(t,e,s){return(0,c.isNumber)(t)?this._getChartApi().requestMoreTickmarks(this.sessionId(),t):this._getChartApi().requestMoreTickmarks(this.sessionId(),t,e,s)}requestMetadata(t,e){this._getChartApi().requestMetadata(this.sessionId(),t,e)}canCreateStudy(t){return this._getChartApi().canCreateStudy(t)}createStudy(t,e,s,i,r,o,a){return this._getChartApi().createStudy(this.sessionId(),t,e,s,i,r,o,a)}rebindStudy(t,e,s,i,r,o,a){return this._getChartApi().rebindStudy(this.sessionId(),t,e,s,i,r,o,a)}modifyStudy(t,e,s,i,r){return this._getChartApi().modifyStudy(this.sessionId(),t,e,s,i,r)}removeStudy(t,e){return this._getChartApi().removeStudy(this.sessionId(),t,e)}createPointset(t,e,s,i,r,o){return this._getChartApi().createPointset(this.sessionId(),t,e,s,i,r,o)}modifyPointset(t,e,s,i){return this._getChartApi().modifyPointset(this.sessionId(),t,e,s,i)}removePointset(t){return this._getChartApi().removePointset(this.sessionId(),t)}setVisibleTimeRange(t,e,s,i,r,o){0}criticalError(){return this._criticalError}connect(t=null){null!==t&&(this._handler=t),this._symbolResolveMap.clear(),super.connect()}setHandler(t){this._handler=t}connected(){return this.isConnected().value()&&!this._sessionDisabled}disable(){this._sessionDisabled=!0}chartApi(){return this._getChartApi()}_sendCreateSession(){Object.keys(this).forEach((t=>{/^(s|st|symbol_)\d+$/.test(t)&&delete this[t]})),this._getChartApi().chartCreateSession(this.sessionId(),this._disableStatistics)}_sendRemoveSession(){this._getChartApi().chartDeleteSession(this.sessionId())}_onMessage(t){this._handler&&this._handler(t)}_onCriticalError(t,e){this._criticalError.fire(t,e),super._onCriticalError(t,e)}}},674981:(t,e,s)=>{"use strict";s.d(e,{lowerbound:()=>i,upperbound:()=>r});s(650151);function i(t,e,s,i=0,r=t.length){return function(t,e,s,i,r){let o=r-i;for(;0<o;){const r=o>>1,a=i+r;s(t(a),e)?(i=a+1,o-=r+1):o=r}return i}((e=>t[e]),e,s,i,r)}function r(t,e,s,i=0,r=t.length){let o=r-i;for(;0<o;){const r=o>>1,a=i+r;s(e,t[a])?o=r:(i=a+1,o-=r+1)}return i}},938550:(t,e,s)=>{"use strict";s.d(e,{WatchedObject:()=>n});var i=s(6826),r=s.n(i),o=s(389137);function a(t,e){return(0,o.deepEquals)(t,e)[0]}class n extends(r()){constructor(t,e=a){super(t),this._comparator=e}setValue(t,e){!1===this._comparator(this.value(),t)&&super.setValue(t,e)}}},551775:(t,e,s)=>{"use strict";s.d(e,{customFormatters:()=>i});const i={dateFormatter:null,timeFormatter:null,tickMarkFormatter:null,
priceFormatterFactory:null,studyFormatterFactory:null}},157954:(t,e,s)=>{"use strict";s.d(e,{DateFormatter:()=>o});var i=s(551775),r=s(958067);class o{constructor(t="yyyy-MM-dd",e=!1){this._dateFormatFunc=e?(0,r.getDateFormatWithWeekday)(t):r.dateFormatFunctions[t]}format(t){return i.customFormatters&&i.customFormatters.dateFormatter?i.customFormatters.dateFormatter.format(t):this._dateFormatFunc(t,!1)}formatLocal(t){return i.customFormatters.dateFormatter?i.customFormatters.dateFormatter.formatLocal?i.customFormatters.dateFormatter.formatLocal(t):i.customFormatters.dateFormatter.format(t):this._dateFormatFunc(t,!0)}}},714688:(t,e,s)=>{"use strict";s.d(e,{DateTimeFormatter:()=>a});var i=s(716714),r=s(157954);const o={dateFormat:"yyyy-MM-dd",withWeekday:!1,timeFormat:i.hourMinuteSecondFormat,dateTimeSeparator:" "};class a{constructor(t={}){const e=Object.assign({},o,t);this._dateFormatter=new r.DateFormatter(e.dateFormat,e.withWeekday),this._timeFormatter=new i.TimeFormatter(e.timeFormat),this._separator=e.dateTimeSeparator}format(t){return`${this._dateFormatter.format(t)}${this._separator}${this._timeFormatter.format(t)}`}formatLocal(t){return`${this._dateFormatter.formatLocal(t)}${this._separator}${this._timeFormatter.formatLocal(t)}`}}},716714:(t,e,s)=>{"use strict";s.d(e,{TimeFormatter:()=>u,hourMinuteFormat:()=>n,hourMinuteNonZeroSecondFormat:()=>a,hourMinuteSecondFormat:()=>o,twelveHourMinuteFormat:()=>c,twelveHourMinuteNonZeroSecondFormat:()=>h,twelveHourMinuteSecondFormat:()=>l});var i=s(551775),r=s(624444);const o="%h:%m:%s",a="%h:%m:%s+",n="%h:%m",l="%h:%m:%s %ampm",h="%h:%m:%s+ %ampm",c="%h:%m %ampm";class u{constructor(t){this._isTwelveHoursFormat=!1,this._valuesAndDelimeters=[];const e=t||o,s=new RegExp("%h|%m|%s\\+|%ss|%ampm|%s","g");let i=s.exec(e),r=0;for(;null!==i;){const t=i[0];"%ampm"===t&&(this._isTwelveHoursFormat=!0);const o=e.substring(r,i.index);""!==o&&this._valuesAndDelimeters.push(o),this._valuesAndDelimeters.push(t),r=i.index+t.length,i=s.exec(e)}}format(t){return i.customFormatters.timeFormatter?i.customFormatters.timeFormatter.format(t):this._formatTime(t,!1)}formatLocal(t){return i.customFormatters.timeFormatter?i.customFormatters.timeFormatter.formatLocal?i.customFormatters.timeFormatter.formatLocal(t):i.customFormatters.timeFormatter.format(t):this._formatTime(t,!0)}_formatTime(t,e){let s=e?t.getHours():t.getUTCHours();const i=e?t.getMinutes():t.getUTCMinutes(),o=e?t.getSeconds():t.getUTCSeconds(),a=e?t.getMilliseconds():t.getUTCMilliseconds();let n="";this._isTwelveHoursFormat&&(n=s>=12?"PM":"AM",s%=12,s=s||12);let l="",h=!1;for(let t=this._valuesAndDelimeters.length-1;t>=0;t--){const e=this._valuesAndDelimeters[t];let c;switch(e){case"%h":c=(0,r.numberToStringWithLeadingZero)(s,2);break;case"%m":c=(0,r.numberToStringWithLeadingZero)(i,2);break;case"%s+":0!==o?c=(0,r.numberToStringWithLeadingZero)(o,2):(c="",h=!0);break;case"%s":c=(0,r.numberToStringWithLeadingZero)(o,2);break;case"%ss":c=(0,r.numberToStringWithLeadingZero)(a,3);break;case"%ampm":c=n;break;default:if(h){h=!1;continue}
c=e}l=c+l}return l}}},943994:(t,e,s)=>{"use strict";s.d(e,{PLACE_HOLDER:()=>a,VolumeFormatter:()=>n});var i=s(777754),r=s(182436),o=s(389137);const a="---";class n{constructor(t){this.type="volume",this._numericFormatter=new r.NumericFormatter,this._fractionalValues=void 0!==t&&t>0,this._precision=t}state(){return{precision:this._precision}}format(t,e){if(!(0,o.isNumber)(t))return a;let r="";return t<0?(r="−",t=-t):t>0&&e&&(r="+"),t>=1e100?i.t(null,void 0,s(343088)):(!this._fractionalValues||t>=995?t=Math.round(t):this._fractionalValues&&(t=+t.toFixed(this._precision)),t<995?r+this._formatNumber(t):t<999995?r+this._formatNumber(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),r+this._formatNumber(t/1e6)+"M"):t<999999999995?(t=1e6*Math.round(t/1e6),r+this._formatNumber(t/1e9)+"B"):(t=1e9*Math.round(t/1e9),r+this._formatNumber(t/1e12)+"T"))}parse(t){if("---"===t)return{error:"not a number",res:!1,value:NaN};const e={K:1e3,M:1e6,B:1e9,T:1e12},s=t.slice(-1);if(e.hasOwnProperty(s)){const i=this._numericFormatter.parse(t.slice(0,-1));return(0,o.isNumber)(i)?{res:!0,value:i*e[s]}:{error:"not a number",res:!1,value:NaN}}{const e=this._numericFormatter.parse(t);return(0,o.isNumber)(e)?{res:!0,value:e}:{error:"not a number",res:!1,value:NaN}}}static serialize(t){return t.state()}static deserialize(t){return new n(t.precision)}_formatNumber(t){if(this._fractionalValues&&0!==t){const e=14-Math.ceil(Math.log10(t)),s=Math.pow(10,e);t=Math.round(t*s)/s}return this._numericFormatter.format(t).replace(/(\.[1-9]*)0+$/,((t,e)=>e))}}},534741:(t,e,s)=>{"use strict";var i;s.d(e,{PlotRowSearchMode:()=>i}),function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.Exact=0]="Exact",t[t.NearestRight=1]="NearestRight"}(i||(i={}))},826989:(t,e,s)=>{"use strict";var i;s.d(e,{SymbolErrorPermissionDeniedReason:()=>i,invalidSymbol:()=>o,permissionDenied:()=>r}),function(t){t.Symbol="symbol",t.GroupPermission="group"}(i||(i={}));const r="permission denied",o="invalid symbol"},195447:(t,e,s)=>{"use strict";s.d(e,{PlotList:()=>d});var i=s(650151),r=s(674981),o=s(732149),a=s(201089),n=s(534741);const l=(0,a.getLogger)("Chart.PlotList"),h=30;function c(t){return t.index}function u(t){return t.value[0]}class d{constructor(t=null,e=null){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache=new Map,this._rowSearchCacheByIndex=new Map,this._rowSearchCacheByIndexWithoutEmptyValues=new Map,this._rowSearchCacheByTime=new Map,this._rowSearchCacheByTimeWithoutEmptyValues=new Map,this._plotFunctions=t||new Map,this._emptyValuePredicate=e}clear(){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache.clear(),this._invalidateSearchCaches()}first(){return this.size()>0?this._items[this._start]:null}last(){return this.size()>0?this._items[this._end-1]:null}firstIndex(){return this.size()>0?this._indexAt(this._start):null}lastIndex(){return this.size()>0?this._indexAt(this._end-1):null}size(){return this._end-this._start}isEmpty(){return 0===this.size()}contains(t){return null!==this.search(t,n.PlotRowSearchMode.Exact)}valueAt(t){
const e=this.search(t);return null!==e?e.value:null}add(t,e){if(this._shareRead)return l.logDebug("add: readonly collection modification attempt"),!1;const s={index:t,value:e},i=this._nonCachedSearch(t,n.PlotRowSearchMode.Exact,c);return this._invalidateSearchCaches(),null===i?(this._items.splice(this._lowerbound(t,c),0,s),this._start=0,this._end=this._items.length,!0):(this._items[i]=s,!1)}search(t,e=n.PlotRowSearchMode.Exact,s){return this._searchImpl(t,e,this._rowSearchCacheByIndex,this._rowSearchCacheByIndexWithoutEmptyValues,c,s)}searchByTime(t,e=n.PlotRowSearchMode.Exact,s){return this._searchImpl(t,e,this._rowSearchCacheByTime,this._rowSearchCacheByTimeWithoutEmptyValues,u,s)}fold(t,e){let s=e;for(let e=this._start;e<this._end;++e){s=t(this._indexAt(e),this._valueAt(e),s)}return s}findFirst(t,e){const s=void 0!==e&&Math.min(this._start+e,this._end)||this._end;for(let e=this._start;e<s;++e){const s=this._indexAt(e),i=this._valueAt(e);if(t(s,i))return{index:s,value:i}}return null}findLast(t,e){const s=void 0!==e&&Math.max(this._end-e,this._start)||this._start;for(let e=this._end-1;e>=s;--e){const s=this._indexAt(e),i=this._valueAt(e);if(t(s,i))return{index:s,value:i}}return null}each(t){for(let e=this._start;e<this._end;++e){if(t(this._indexAt(e),this._valueAt(e)))break}}reduce(t,e){let s=e;for(let e=this._start;e<this._end;++e){s=t(s,this._indexAt(e),this._valueAt(e))}return s}range(t,e){const s=new d(this._plotFunctions,this._emptyValuePredicate);return s._items=this._items,s._start=this._lowerbound(t,c),s._end=this._upperbound(e),s._shareRead=!0,s}plottableRange(t){const e=new d(this._plotFunctions,this._emptyValuePredicate);return e._items=this._items,e._start=this._upperbound(o.UNPLOTTABLE_TIME_POINT_INDEX),e._end=this._end,e._shareRead=!0,!0===t&&e._start>this._start&&(e._start-=1),e}rangeIterator(t,e){const s=this._lowerbound(t,c),i=this._upperbound(e);if(s===i)return{hasNext:()=>!1,next:()=>{throw new Error("Invalid operation")}};let r=s-1;return{hasNext:()=>r<i-1,next:()=>(r+=1,this._items[r])}}minMaxOnRangeCached(t,e,s){if(this.isEmpty())return null;let i=null;for(const r of s){i=m(i,this._minMaxOnRangeCachedImpl(t-r.offset,e-r.offset,r.name))}return i}minMaxOnRange(t,e,s){if(this.isEmpty())return null;let i=null;for(const r of s){i=m(i,this._minMaxOnRange(t-r.offset,e-r.offset,r.name))}return i}merge(t){return this._shareRead?(l.logDebug("merge: readonly collection modification attempt"),null):0===t.length?null:this.isEmpty()||t[t.length-1].index<this._items[0].index?this._prepend(t):t[0].index>this._items[this._items.length-1].index?this._append(t):1===t.length&&t[0].index===this._items[this._items.length-1].index?(this._updateLast(t[0]),t[0]):this._merge(t)}addTail(t,e=!1){if(0===t.length)return;let s=0;e&&this._end-this._start>0&&(s=1,this._items[this._end-this._start-1].value=t[0].value);for(let e=s;e<t.length;++e){const s=t[e],i=this.lastIndex();if(null===i){l.logError("Can't add tail to the empty plotlist");break}this.add(i+1,s.value)}this._invalidateSearchCaches()}move(t){
if(this._shareRead)return void l.logDebug("move: readonly collection modification attempt");if(0===t.length)return;const e=this._items.slice();for(const s of t){const t=this._bsearch(s.old,c);if(null!==t&&void 0!==e[t])if(s.new===o.INVALID_TIME_POINT_INDEX)e[t]=void 0;else{e[t]={index:s.new,value:e[t].value};const i=this._bsearch(s.new,c);if(null!==i){const t=e[i];void 0!==t&&t.index===s.new&&(e[i]=void 0)}}}this._items=e.filter((t=>void 0!==t)).sort(((t,e)=>t.index-e.index)),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._start=0,this._end=this._items.length}remove(t){if(this._shareRead)return l.logDebug("remove: readonly collection modification attempt"),null;const e=this._nonCachedSearch(t,n.PlotRowSearchMode.NearestRight,c);if(null===e)return null;const s=this._items.splice(e);return this._end=this._items.length,this._minMaxCache.clear(),this._invalidateSearchCaches(),s.length>0?s[0]:null}state(){const t=this._items.slice(this._start,this._end);return{start:0,end:t.length,data:t}}restoreState(t){t?(this._start=t.start,this._end=t.end,this._shareRead=!1,this._items=t.data,this._minMaxCache.clear(),this._invalidateSearchCaches()):this.clear()}_indexAt(t){return this._items[t].index}_valueAt(t){return this._items[t].value}_length(){return this._items.length}_searchImpl(t,e,s,i,r,o){const a=void 0!==o?s:i,n=void 0!==o?1e4*(e+1)+o:e;let l=a.get(t);if(void 0!==l){const t=l.get(n);if(void 0!==t)return t}const h=this._nonCachedSearch(t,e,r,o);if(null===h)return null;const c={index:this._indexAt(h),value:this._valueAt(h)};return void 0===l&&(l=new Map,a.set(t,l)),l.set(n,c),c}_nonCachedSearch(t,e,s,i){const r=this._lowerbound(t,s),o=r===this._end||t!==s(this._items[r]);if(o&&e!==n.PlotRowSearchMode.Exact)switch(e){case n.PlotRowSearchMode.NearestLeft:return this._searchNearestLeft(r,i);case n.PlotRowSearchMode.NearestRight:return this._searchNearestRight(r,i);default:throw new TypeError("Unknown search mode")}if(void 0===i||o||e===n.PlotRowSearchMode.Exact)return o?null:r;switch(e){case n.PlotRowSearchMode.NearestLeft:return this._nonEmptyNearestLeft(r,i);case n.PlotRowSearchMode.NearestRight:return this._nonEmptyNearestRight(r,i);default:throw new TypeError("Unknown search mode")}}_nonEmptyNearestRight(t,e){const s=(0,i.ensure)(this._emptyValuePredicate),r=(0,i.ensure)(e);for(;t<this._end&&s(this._valueAt(t),r);)t+=1;return t===this._end?null:t}_nonEmptyNearestLeft(t,e){const s=(0,i.ensureNotNull)(this._emptyValuePredicate),r=(0,i.ensure)(e);for(;t>=this._start&&s(this._valueAt(t),r);)t-=1;return t<this._start?null:t}_searchNearestLeft(t,e){if(t===this._start)return null;const s=t-1,i=s!==this._end?s:null;return void 0!==e&&null!==i?this._nonEmptyNearestLeft(i,e):i}_searchNearestRight(t,e){const s=t,i=s!==this._end?s:null;return void 0!==e&&null!==i?this._nonEmptyNearestRight(i,e):i}_bsearch(t,e){const s=this._lowerbound(t,e);return s!==this._end&&t===e(this._items[s])?s:null}_lowerbound(t,e){return(0,r.lowerbound)(this._items,t,((t,s)=>e(t)<s),this._start,this._end)}_upperbound(t){return(0,
r.upperbound)(this._items,t,((t,e)=>e.index>t),this._start,this._end)}_plotMinMax(t,e,s){let i=null;const r=this._plotFunctions.get(s);if(void 0===r)throw new Error(`Plot "${s}" is not registered`);for(let s=t;s<e;s++){const t=r(this._items[s].value);null==t||Number.isNaN(t)||(null===i?i={min:t,max:t}:(t<i.min&&(i.min=t),t>i.max&&(i.max=t)))}return i}_invalidateCacheForRow(t){const e=Math.floor(t.index/h);this._minMaxCache.forEach((t=>t.delete(e)))}_prepend(t){return(0,i.assert)(!this._shareRead,"collection should not be readonly"),(0,i.assert)(0!==t.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=t.concat(this._items),this._start=0,this._end=this._items.length,t[0]}_append(t){return(0,i.assert)(!this._shareRead,"collection should not be readonly"),(0,i.assert)(0!==t.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=this._items.concat(t),this._start=0,this._end=this._items.length,t[0]}_updateLast(t){(0,i.assert)(!this.isEmpty(),"plot list should not be empty");const e=this._items[this._end-1];(0,i.assert)(e.index===t.index,"last row index should match new row index"),this._invalidateCacheForRow(t),this._invalidateSearchCaches(),this._items[this._end-1]=t}_merge(t){return(0,i.assert)(0!==t.length,"plot rows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=function(t,e){const s=function(t,e){const s=t.length,i=e.length;let r=s+i,o=0,a=0;for(;o<s&&a<i;)t[o].index<e[a].index?o++:t[o].index>e[a].index?a++:(o++,a++,r--);return r}(t,e),i=new Array(s);let r=0,o=0;const a=t.length,n=e.length;let l=0;for(;r<a&&o<n;)t[r].index<e[o].index?(i[l]=t[r],r++):t[r].index>e[o].index?(i[l]=e[o],o++):(i[l]=e[o],r++,o++),l++;for(;r<a;)i[l]=t[r],r++,l++;for(;o<n;)i[l]=e[o],o++,l++;return i}(this._items,t),this._start=0,this._end=this._items.length,t[0]}_minMaxOnRangeCachedImpl(t,e,s){if(this.isEmpty())return null;let r=null;const o=(0,i.ensureNotNull)(this.firstIndex()),a=(0,i.ensureNotNull)(this.lastIndex()),n=Math.max(t,o),l=Math.min(e,a),c=Math.ceil(n/h)*h,u=Math.max(c,Math.floor(l/h)*h);r=m(r,this._minMaxOnRange(n,Math.min(c,e,l),s));let d=this._minMaxCache.get(s);void 0===d&&(d=new Map,this._minMaxCache.set(s,d));for(let t=Math.max(c+1,n);t<u;t+=h){const e=Math.floor(t/h);let i=d.get(e);if(void 0===i){const t=e*h,r=(e+1)*h-1;i=this._minMaxOnRange(t,r,s),d.set(e,i)}r=m(r,i)}r=m(r,this._minMaxOnRange(u,l,s));return r}_minMaxOnRange(t,e,s){return this._plotMinMax(this._lowerbound(t,c),this._upperbound(e),s)}_invalidateSearchCaches(){this._rowSearchCacheByIndex.clear(),this._rowSearchCacheByIndexWithoutEmptyValues.clear(),this._rowSearchCacheByTime.clear(),this._rowSearchCacheByTimeWithoutEmptyValues.clear()}}function m(t,e){if(null===t)return e;if(null===e)return t;return{min:Math.min(t.min,e.min),max:Math.max(t.max,e.max)}}},544421:(t,e,s)=>{"use strict";s.d(e,{SeriesData:()=>d});var i,r=s(650151),o=s(195447),a=s(674981);!function(t){t[t.FromLeft=-1]="FromLeft",
t[t.FromRight=1]="FromRight"}(i||(i={}));const n={open:t=>t[1],high:t=>t[2],low:t=>t[3],close:t=>t[4],hl2:t=>(t[2]+t[3])/2,hlc3:t=>(t[2]+t[3]+t[4])/3,ohlc4:t=>(t[1]+t[2]+t[3]+t[4])/4},l=["open","high","low","close","hl2","hlc3","ohlc4"];function h(){const t=new Map;return l.forEach(((e,s)=>{t.set(e,function(t,e,s){const i=n[null!=e?e:t],r=n[t],o=n[null!=s?s:t];return(t,e)=>{switch(e){case 0:return i(t);case 2:return o(t);default:return r(t)}}}(e))})),t}function c(t,e){return null==t[e]}const u=[{barsToMerge:10,forBarspacingLargerThen:.03},{barsToMerge:30,forBarspacingLargerThen:.01},{barsToMerge:100,forBarspacingLargerThen:.003},{barsToMerge:500,forBarspacingLargerThen:0}];class d{constructor(){this._pressedChunks={chunks:new Map,priceSource:"uninitialized"},this.m_bars=new o.PlotList(h(),c),this.m_nsBars=new o.PlotList(h(),c),this._clearPressedChunks()}bars(){return this.m_bars}nsBars(){return this.m_nsBars}pressedChunks(t,e){if(e!==this._pressedChunks.priceSource){this._pressedChunks.priceSource=e;const t=this.m_bars.first();t&&(this._clearPressedChunks(),this._rebuildPressedChunks(t))}const s=(0,r.ensureDefined)(u.find((e=>e.forBarspacingLargerThen<=t)));return(0,r.ensureDefined)(this._pressedChunks.chunks.get(s.barsToMerge))}mergeRegularBars(t){const e=this.m_bars.size(),s=this.m_bars.merge(t);return s&&"uninitialized"!==this._pressedChunks.priceSource&&(e===this.m_bars.size()&&s.index===this.m_bars.lastIndex()?this._updateLatestChunks():this._rebuildPressedChunks(s)),s}size(){return this.m_bars.size()+this.m_nsBars.size()}each(t){this.m_bars.each(t),this.m_nsBars.each(t)}clear(){this.m_bars.clear(),this.m_nsBars.clear(),this.lastProjectionPrice=void 0,this._clearPressedChunks()}isEmpty(){return this.m_bars.isEmpty()&&this.m_nsBars.isEmpty()}first(){return this.m_bars.isEmpty()?this.m_nsBars.first():this.m_bars.first()}last(){return this.m_nsBars.isEmpty()?this.m_bars.last():this.m_nsBars.last()}search(t,e){return this.nsBars().isEmpty()?this.bars().search(t,e):this.bars().isEmpty()||(0,r.ensureNotNull)(this.nsBars().firstIndex())<=t?this.nsBars().search(t,e):this.bars().search(t,e)}valueAt(t){const e=this.search(t);return null!==e?e.value:null}plotValueToTimePointIndex(t,e,s){if(s===i.FromRight){const s=(s,i)=>{const r=i[e];return null!=r&&t>=r},i=this.m_bars.findLast(s);if(null!==i)return i.index;const r=this.m_nsBars.findLast(s);return null!==r?r.index:this.m_bars.firstIndex()}if(s===i.FromLeft){const s=(s,i)=>{const r=i[e];return null!=r&&t<=r},i=this.m_bars.findFirst(s);if(null!==i)return i.index;const r=this.m_nsBars.findFirst(s);return null!==r?r.index:this.m_bars.lastIndex()}throw new Error("plotValueToTimePointIndex: unsupported search mode")}moveData(t){this.m_bars.move(t),this.m_nsBars.move(t),this.m_bars.size()>0&&this._rebuildPressedChunks((0,r.ensureNotNull)(this.m_bars.first()))}_rebuildPressedChunks(t){const e=this._pressedChunks.priceSource;if("uninitialized"===e)return;const s=t.index,i=n[e],o=(t,e,s)=>{let r=null;for(;t.hasNext();){const o=t.next(),a=i(o.value)
;r&&o.index-r.startTime>=s.barsToMerge&&(e.push(r),r=null),r?(r.endTime=o.index,r.high=Math.max(r.high,a),r.low=Math.min(r.low,a),r.close=a):r={startTime:o.index,endTime:o.index,open:a,high:a,low:a,close:a}}r&&e.push(r)};u.forEach((t=>{const e=(0,r.ensureDefined)(this._pressedChunks.chunks.get(t.barsToMerge)),i=(0,a.lowerbound)(e,s,((t,e)=>t.endTime<e));if(0===i&&e.length>0){const s=e[0].startTime-1,i=(0,r.ensureNotNull)(this.m_bars.firstIndex()),a=this.m_bars.rangeIterator(i,s),n=[];o(a,n,t);const l=n.concat(e);this._pressedChunks.chunks.set(t.barsToMerge,l)}else{const s=(0,r.ensureNotNull)(this.m_bars.lastIndex());e.splice(i);let a=(0,r.ensureNotNull)(this.m_bars.firstIndex());e.length&&(a=e[e.length-1].endTime+1);const n=this.m_bars.rangeIterator(a,s);o(n,e,t)}}))}_updateLatestChunks(){const t=(0,r.ensureNotNull)(this.m_bars.lastIndex());u.forEach((e=>{const s=(0,r.ensureDefined)(this._pressedChunks.chunks.get(e.barsToMerge)),i=this.m_bars.rangeIterator(t,t).next(),o=i.value[4],a=s[s.length-1];a.high=Math.max(a.high,o),a.low=Math.min(a.low,o),a.close=o,a.endTime=i.index}))}_clearPressedChunks(){u.forEach((t=>this._pressedChunks.chunks.set(t.barsToMerge,[])))}}},442410:(t,e,s)=>{"use strict";s.d(e,{SeriesDataEvents:()=>o});var i=s(707957),r=s.n(i);class o{constructor(){this._created=new(r()),this._modified=new(r()),this._loading=new(r()),this._completed=new(r()),this._error=new(r()),this._symbolError=new(r()),this._symbolResolved=new(r()),this._seriesError=new(r()),this._symbolNotPermitted=new(r()),this._symbolInvalid=new(r()),this._symbolGroupNotPermitted=new(r()),this._chartTypeNotPermitted=new(r()),this._intradaySpreadNotPermitted=new(r()),this._intradayExchangeNotPermitted=new(r()),this._customIntervalNotPermitted=new(r()),this._secondsIntervalNotPermitted=new(r()),this._tickMarksRangeChanged=new(r()),this._barReceived=new(r()),this._seriesTimeFrame=new(r()),this._dataUpdated=new(r())}destroy(){this._created.destroy(),this._modified.destroy(),this._loading.destroy(),this._completed.destroy(),this._error.destroy(),this._symbolError.destroy(),this._symbolResolved.destroy(),this._seriesError.destroy(),this._symbolInvalid.destroy(),this._symbolNotPermitted.destroy(),this._symbolGroupNotPermitted.destroy(),this._chartTypeNotPermitted.destroy(),this._intradaySpreadNotPermitted.destroy(),this._intradayExchangeNotPermitted.destroy(),this._customIntervalNotPermitted.destroy(),this._secondsIntervalNotPermitted.destroy(),this._tickMarksRangeChanged.destroy(),this._barReceived.destroy(),this._seriesTimeFrame.destroy(),this._dataUpdated.destroy()}created(){return this._created}modified(){return this._modified}loading(){return this._loading}completed(){return this._completed}error(){return this._error}symbolError(){return this._symbolError}symbolResolved(){return this._symbolResolved}seriesError(){return this._seriesError}symbolInvalid(){return this._symbolInvalid}symbolNotPermitted(){return this._symbolNotPermitted}symbolGroupNotPermitted(){return this._symbolGroupNotPermitted}chartTypeNotPermitted(){
return this._chartTypeNotPermitted}intradaySpreadNotPermitted(){return this._intradaySpreadNotPermitted}intradayExchangeNotPermitted(){return this._intradayExchangeNotPermitted}customIntervalNotPermitted(){return this._customIntervalNotPermitted}secondsIntervalNotPermitted(){return this._secondsIntervalNotPermitted}tickMarksRangeChanged(){return this._tickMarksRangeChanged}barReceived(){return this._barReceived}seriesTimeFrame(){return this._seriesTimeFrame}dataUpdated(){return this._dataUpdated}fireCompleted(t){this._completed.fire(t)}fireCreated(t){this._created.fire(t)}fireModified(){this._modified.fire()}fireLoading(t){this._loading.fire(t)}fireError(){this._error.fire()}fireSymbolError(t){this._symbolError.fire(t),this.fireError()}fireSymbolResolved(t){this._symbolResolved.fire(t)}fireSeriesError(t){this._seriesError.fire(t),this.fireError()}fireSymbolInvalid(){this._symbolInvalid.fire()}fireSymbolNotPermitted(t){this._symbolNotPermitted.fire(t)}fireSymbolGroupNotPermitted(t){this._symbolGroupNotPermitted.fire(t)}fireChartTypeNotPermitted(t){this._chartTypeNotPermitted.fire(t),this.fireError()}fireIntradaySpreadNotPermitted(){this._intradaySpreadNotPermitted.fire(),this.fireError()}fireIntradayExchangeNotPermitted(){this._intradayExchangeNotPermitted.fire(),this.fireError()}fireCustomIntervalNotPermitted(t){this._customIntervalNotPermitted.fire(t),this.fireError()}fireSecondsIntervalNotPermitted(){this._secondsIntervalNotPermitted.fire(),this.fireError()}fireTickMarksRangeChanged(t){this._tickMarksRangeChanged.fire(t)}fireBarReceived(t){this._barReceived.fire(t)}fireSeriesTimeFrame(t,e,s,i,r){this._seriesTimeFrame.fire(t,e,s,i,r)}fireDataUpdated(t,e,s){this._dataUpdated.fire(t,e,s)}}},175878:(t,e,s)=>{"use strict";s.d(e,{SeriesDataSource:()=>v});var i=s(650151),r=s(389137),o=s(919892),a=s(223699),n=s(544421),l=s(178389),h=s(826989),c=s(442410),u=s(201089),d=s(444331);const m=(0,u.getLogger)("Chart.SeriesDataSource");var _;!function(t){t[t.Idle=0]="Idle",t[t.AwaitingConnection=1]="AwaitingConnection",t[t.AwaitingFirstDataUpdate=2]="AwaitingFirstDataUpdate",t[t.Active=3]="Active"}(_||(_={}));let p=1;let g=1;function f(t){return t.startDate?t.endDate||t.count?t.endDate?["from_to",t.startDate,t.endDate]:["bar_count",t.startDate,(0,i.ensure)(t.count)]:["from_to",t.startDate]:t.count||300}class v{constructor(t,e,s,i){this._symbol=null,this._resolvedSymbolName=null,this._createSeriesOverriddenParams=0,this._instanceId=null,this._symbolInstanceId=null,this._resolution=null,this._timeFrame=null,this._data=new n.SeriesData,this._dataEvents=new c.SeriesDataEvents,this._status=_.Idle,this._turnaroundCounter=1,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=t,this._turnaroundPrefix=e,this._createSeriesParams=f(null!=s?s:{count:300}),this._timeFrame=i||null,this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged)}
modifySeries(t,e,s=null,o=!1){o&&(m.logNormal("Due to force flag clearing symbol & resolution to force re-requesting data."),this._symbol=null,this._resolution=null);const n=this._symbol,l=this._resolution;if(this._symbol=t,this._resolution=e,null===this._instanceId)return void(this._timeFrame=s);const h=!(0,r.deepEquals)(n,t)[0]||null!==this._resolvedSymbolName&&this._resolvedSymbolName!==this._getSymbolNameString(t),c=null===l||!a.Interval.isEqual(l,e);(h||c||null!==s)&&(this._timeFrame=null,(h||c)&&this._turnaroundCounter++,h&&this._resolveSymbol(),this._gateway.modifySeries(this._instanceId,this.turnaround(),(0,i.ensureNotNull)(this._symbolInstanceId),this._resolution,s,this._onMessage.bind(this)),this._dataEvents.fireModified())}requestMoreData(t){null!==this._instanceId&&this._gateway.requestMoreData(this._instanceId,t,this._onMessage.bind(this))}requestMoreTickmarks(t){null!==this._instanceId&&this._gateway.requestMoreTickmarks(this._instanceId,t,this._onMessage.bind(this))}isStarted(){return this._status!==_.Idle}isActive(){return this._status===_.Active}resolution(){return this._resolution}start(){this.isStarted()?m.logNormal("start: data source is already started, nothing to do"):((0,i.assert)(null!==this._symbol,"symbol must be set before start"),(0,i.assert)(null!==this._resolution,"resolution must be set before start"),this._gateway.isConnected().value()?this._createSeries():this._changeStatusTo(_.AwaitingConnection))}stop(){this.isStarted()?(null!==this._instanceId&&(this._gateway.removeSeries(this._instanceId),this._instanceId=null),this._changeStatusTo(_.Idle)):m.logNormal("stop: data source is already stopped, nothing to do")}instanceId(){return this._instanceId}data(){return this._data}clearData(){this.isStarted()?this._enqueueUpdate((()=>this._clearDataImpl())):this._clearDataImpl()}dataEvents(){return this._dataEvents}turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}symbolInstanceId(){return this._symbolInstanceId}symbol(){return this._symbol}moveData(t){this._enqueueUpdate((()=>this._data.moveData(t)))}setInitialRequestOptions(t){this._createSeriesOverriddenParams=f(t)}_resolveSymbol(){null!==this._symbol&&(this._symbolInstanceId=this._gateway.resolveSymbol("sds_sym_"+p++,(0,o.encodeExtendedSymbolOrGetSimpleSymbolString)(this._symbol),this._onMessage.bind(this)))}_clearDataImpl(){this._data.clear()}_changeStatusTo(t){(0,i.assert)(this._status!==t,"Source and destination status should be distinct"),m.logNormal(`Status changed from ${_[this._status]} to ${_[t]}`),this._status=t}_createSeries(){(0,i.assert)(this._status!==_.Active,'Status should not be "Active" when creating a study'),this._instanceId="sds_"+g++,this._resolveSymbol();const t=this._createSeriesOverriddenParams||this._createSeriesParams;this._createSeriesOverriddenParams&&(this._createSeriesOverriddenParams=0),this._gateway.createSeries(this._instanceId,this.turnaround(),(0,i.ensureNotNull)(this._symbolInstanceId),(0,i.ensureNotNull)(this._resolution),t,this._timeFrame,this._onMessage.bind(this)),
this._timeFrame=null,this._changeStatusTo(_.AwaitingFirstDataUpdate),this._dataEvents.fireCreated(this._instanceId)}_onGatewayIsConnectedChanged(t){t?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===_.AwaitingConnection&&this._createSeries()}_onGatewayDisconnected(){this._status!==_.Idle&&this._status!==_.AwaitingConnection&&(this._instanceId=null,this._changeStatusTo(_.AwaitingConnection)),this._turnaroundCounter=1}_onMessage(t){this._enqueueUpdate((()=>this._onMessageImpl(t)))}async _onMessageImpl(t){switch(t.method){case"symbol_resolved":{const[e,s]=t.params;if(e!==this._symbolInstanceId){m.logNormal(`Resolve for old symbol, expected: ${this._symbolInstanceId}, actual ${t.params[0]}`);break}this._onSymbolResolved(s);break}case"symbol_error":if(t.params[0]!==this._symbolInstanceId){m.logNormal(`Symbol error for old symbol, expected: ${this._symbolInstanceId}, actual ${t.params[0]}`);break}this._onSymbolError(t);break;case"series_timeframe":{const[e,s,i,r,o,a,n]=t.params;if(!this._checkTurnaround(e,s)){m.logNormal(`Time frame for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${s})`);break}this._onSeriesTimeFrame(i,r,o,a,n);break}case"series_error":{const[e,s]=t.params;if(!this._checkTurnaround(e,s)){m.logNormal(`Series error for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${s})`);break}this._onSeriesError(t.params[2]);break}case"series_loading":{const[e,s]=t.params;if(!this._checkTurnaround(e,s))break;this._onSeriesLoading(t.time);break}case"series_completed":{const[e,s,i,r]=t.params;if(!this._checkTurnaround(e,i)){m.logNormal(`Series completed for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${e} (${i})`);break}this._onSeriesCompleted(s,t.time,r);break}case"data_update":if(!this._checkTurnaround(t.params.customId,t.params.turnaround)){m.logNormal(`Data update for old data, expected: ${this._symbolInstanceId} (${this.turnaround()}), actual ${t.params.customId} (${t.params.turnaround})`);break}await this._onDataUpdate(t.params.plots,t.params.nonseries,t.params.lastBar);break;case"clear_data":if(t.params.turnaround!==this.turnaround()){m.logNormal(`Clear data for old data, expected: ${this.turnaround()}, actual ${t.params.turnaround}`);break}this._clearDataImpl(),this._dataEvents.fireDataUpdated(void 0,!1,null)}}_onSeriesError(t){let e,s;if("string"==typeof t)s={error:t},e=t;else if(s=t,t.ctx){const s={};Object.entries(t.ctx).forEach((([t,e])=>{s[t]=e.toString()})),e=t.error.format(s)}else e=t.error;if(e.startsWith("study_not_auth:")){const t=e.split(":",2)[1].split("@",2)[0];if(["BarSetRenko","BarSetPriceBreak","BarSetKagi","BarSetPnF"].includes(t))this._dataEvents.fireChartTypeNotPermitted(t);else if("BarSetSpread"===t)this._dataEvents.fireIntradaySpreadNotPermitted();else if("BarSetRange"===t){const t=`${(0,i.ensureNotNull)(this._symbol).inputs.range}R`;this._dataEvents.fireCustomIntervalNotPermitted(t)}
}else"resolution_not_entitled"===e?this._dataEvents.fireIntradayExchangeNotPermitted():"custom_resolution"===e?this._dataEvents.fireCustomIntervalNotPermitted((0,i.ensureNotNull)(this._resolution)):"seconds_not_entitled"===e&&this._dataEvents.fireSecondsIntervalNotPermitted();this._dataEvents.fireSeriesError(s)}_onSeriesTimeFrame(t,e,s,i,r){this._dataEvents.fireSeriesTimeFrame(t,e,s,null==i||i,r)}_onSymbolError(t){if(t.params[1]===h.permissionDenied)switch(t.params[2]){case h.SymbolErrorPermissionDeniedReason.Symbol:this._dataEvents.fireSymbolNotPermitted(t.params[3]);break;case h.SymbolErrorPermissionDeniedReason.GroupPermission:this._dataEvents.fireSymbolGroupNotPermitted(t.params[3]);break;default:this._dataEvents.fireSymbolNotPermitted(t.params[2])}else t.params[1]===h.invalidSymbol&&this._dataEvents.fireSymbolInvalid();this._dataEvents.fireSymbolError(t.params[1])}_onSymbolResolved(t){this._resolvedSymbolName=(0,d.symbolForApi)(t,this._getSymbolNameString((0,i.ensureNotNull)(this._symbol))),this._dataEvents.fireSymbolResolved(t)}_getSymbolNameString(t){return"string"==typeof t.symbol?t.symbol:t.symbol.symbol}async _onDataUpdate(t,e,s){this._onDataUnpacked(t,s,await async function(t){if(void 0===t)return{projectionPlots:[],boxSize:null};if(""===t.d||"nochange"===t.indexes)return null;const e=await(0,l.unpackNonSeriesData)(t.d);if(null===e||e.indexes_replace)return null;const s=t.indexes,{bars:i,price:r,boxSize:o,reversalAmount:a}=e.data,n=(i||[]).map((t=>{let e;return"factor"in t?e=t.factor:"additionalPrice"in t&&(e=t.additionalPrice),{index:s[t.time],value:[0,t.open,t.high,t.low,t.close,t.volume,e]}}));return{lastPrice:r,projectionPlots:n,reversalAmount:a,boxSize:o}}(e))}_enqueueUpdate(t){return this._ongoingDataUpdate=this._ongoingDataUpdate.then(t,t),this._ongoingDataUpdate}_onDataUnpacked(t,e,s){if(this._status===_.Idle)return;this._status===_.AwaitingFirstDataUpdate&&(this._changeStatusTo(_.Active),this._clearDataImpl());const i=this._data.bars().size(),r=this._data.bars().firstIndex(),o=this._data.mergeRegularBars(t);null!==s&&(this._data.nsBars().clear(),this._data.nsBars().merge(s.projectionPlots),this._data.lastProjectionPrice=s.lastPrice,null!==s.boxSize&&(this._data.boxSize=s.boxSize),this._data.reversalAmount=s.reversalAmount);const a=null===r||null!==o&&o.index<r;this._dataEvents.fireDataUpdated(e,a,o),i!==this._data.bars().size()&&null!==o&&this._dataEvents.fireBarReceived(o)}_onSeriesLoading(t){this._dataEvents.fireLoading(t)}_onSeriesCompleted(t,e,s){this._dataEvents.fireCompleted({updateMode:t,time:e,flags:s})}_checkTurnaround(t,e){return this._instanceId===t&&(void 0===e||e===this.turnaround())}}},133822:(t,e,s)=>{"use strict";s.d(e,{validateGraphicsCommands:()=>o});var i=s(130551),r=s(650151);function o(t){if(!(0,i.isObject)(t))throw new Error("Graphics commands should be wrapped in an object");if((0,i.hasProperty)(t,"create"),(0,i.hasProperty)(t,"erase")){const e=t.erase;(0,r.assert)(Array.isArray(e),"Collection of erase commands should be array");for(const t of e){if(!(0,i.isObject)(t)||!(0,
i.hasProperty)(t,"action"))throw new Error("Command should be an object with 'action' property");(0,r.assert)("all"===t.action||"one"===t.action,"Erase command action should be 'all' or 'one'")}}return t}},732149:(t,e,s)=>{"use strict";s.d(e,{INVALID_TIME_POINT_INDEX:()=>i,UNPLOTTABLE_TIME_POINT_INDEX:()=>r});const i=-2e6,r=-1e6},464539:(t,e,s)=>{"use strict";s.d(e,{getTimeFormatForInterval:()=>r});var i=s(716714);function r(t,e){if(t.isRange())return function(t){return"12-hours"===t?i.twelveHourMinuteNonZeroSecondFormat:i.hourMinuteNonZeroSecondFormat}(e);return t.isSeconds()||t.isTicks()?function(t){return"12-hours"===t?i.twelveHourMinuteSecondFormat:i.hourMinuteSecondFormat}(e):function(t){return"12-hours"===t?i.twelveHourMinuteFormat:i.hourMinuteFormat}(e)}},208817:(t,e,s)=>{"use strict";s.d(e,{getMediumTimeFrameOptions:()=>l,getMiniTimeFrameOptions:()=>n});var i=s(603706);const r=Date.now();function o(t){const e=new Date(r);return e.setMonth(e.getMonth()-t),Math.trunc(e.valueOf()/1e3)}function a(t){const e=new Date(r);return e.setFullYear(e.getFullYear()-t),Math.trunc(e.valueOf()/1e3)}function n(t){const e=(0,i.getTimeFrames)();return[{...e[t?"lastsession":"1d"]},{...e["1m"],targetResolution:"1D",from:o(1)},{...e["3m"],targetResolution:"1D",from:o(3)},{...e["12m"],from:a(1)},{...e["60m"],targetResolution:"1M",from:a(5)},{...e.all}]}function l(){const t=(0,i.getTimeFrames)();return[{...t.lastsession},{...t["1d"]},{...t["1m"],targetResolution:"60",from:o(1)},{...t["3m"],targetResolution:"120",from:o(3)},{...t["12m"],from:a(1)},{...t["60m"],targetResolution:"1W",from:a(5)},{...t.all}]}},603706:(t,e,s)=>{"use strict";s.d(e,{getTimeFrames:()=>r});var i=s(777754);function r(){return{"1d":{text:i.t(null,void 0,s(932120)),value:{value:"1D",type:"period-back"},targetResolution:"1",description:i.t(null,{plural:"%d days",count:1},s(482792)).replace("%d","1")},"5d":{text:i.t(null,void 0,s(905486)),value:{value:"5D",type:"period-back"},targetResolution:"5",description:i.t(null,{plural:"%d days",count:5},s(482792)).replace("%d","5")},"1w":{text:i.t(null,void 0,s(234880)),value:{value:"7D",type:"period-back"},targetResolution:"15",description:i.t(null,{plural:"%d weeks",count:1},s(632123)).replace("%d","1")},"1m":{text:i.t(null,void 0,s(460356)),value:{value:"1M",type:"period-back"},targetResolution:"30",description:i.t(null,{plural:"%d months",count:1},s(117108)).replace("%d","1")},"3m":{text:i.t(null,void 0,s(440675)),value:{value:"3M",type:"period-back"},targetResolution:"60",description:i.t(null,{plural:"%d months",count:3},s(117108)).replace("%d","3")},"6m":{text:i.t(null,void 0,s(281788)),value:{value:"6M",type:"period-back"},targetResolution:"120",description:i.t(null,{plural:"%d months",count:6},s(117108)).replace("%d","6")},ytd:{text:i.t(null,void 0,s(989013)),value:{value:"YTD",type:"period-back"},targetResolution:"1D"},"12m":{text:i.t(null,void 0,s(254790)),value:{value:"12M",type:"period-back"},targetResolution:"1D",description:i.t(null,{plural:"%d years",count:1},s(406550)).replace("%d","1")},"24m":{
text:i.t(null,void 0,s(440956)),value:{value:"24M",type:"period-back"},targetResolution:"1W",description:i.t(null,{plural:"%d years",count:2},s(406550)).replace("%d","2")},"60m":{text:i.t(null,void 0,s(320013)),value:{value:"60M",type:"period-back"},targetResolution:"1W",description:i.t(null,{plural:"%d years",count:5},s(406550)).replace("%d","5")},all:{text:i.t(null,void 0,s(695271)),value:{value:"ALL",type:"period-back"},targetResolution:"1M"},lastsession:{text:i.t(null,void 0,s(932120)),value:{value:"LASTSESSION",type:"period-back"},targetResolution:"1",description:i.t(null,void 0,s(869213))}}}},453290:(t,e,s)=>{"use strict";s.d(e,{getActualTimeFrame:()=>o});var i=s(606311);const r=new Set(Object.values(i.timeFrames).map((t=>t.value.value)));function o(t){if(r.has(t))return t;const e=t.toUpperCase();return r.has(e)?e:"12M"}},606311:(t,e,s)=>{"use strict";s.d(e,{timeFrames:()=>i});const i=(0,s(603706).getTimeFrames)()},663261:(t,e,s)=>{"use strict";s.d(e,{handleTVLinksClick:()=>a});var i=s(439563),r=s(185515),o=s(691239);function a(){document.addEventListener("click",(t=>{const e=t.target.closest(":link");if(!(null==e?void 0:e.hostname)||!(0,o.isInternalHost)(e.hostname,"tradingview.com"))return;const s=e.dataset.targetType||null;!function(t,e){const s=function(){const t=window.initData.hashSettings;if(Object.keys(t).length>0)return(0,r.filterUtmInfo)(t);const e=new URLSearchParams(location.href);return{utm_campaign:e.get("utm_campaign")||void 0,utm_source:e.get("utm_source")||void 0}}(),o=function(t){var e;const s=(null===(e=location.ancestorOrigins)||void 0===e?void 0:e[0])||document.referrer;return t.utm_source||function(t){try{return new URL(t).host}catch(t){return""}}(s)}(s);!async function(t){var e;null===(e=await(0,i.getEmbedWidgetTracker)())||void 0===e||e.trackWidgetTVLinkClick(t)}({widget_type:n(s),domain:o,link:t,target_type:e})}(e.href,s)}))}function n(t){if(t.utm_campaign)return t.utm_campaign;const e=location.pathname;return e.includes("embed-widget")?e.split("/")[2]:e}}}]);